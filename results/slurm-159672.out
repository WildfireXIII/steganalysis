  0%|          | 0/10001 [00:00<?, ?it/s]  4%|▎         | 361/10001 [00:00<00:02, 3604.64it/s]  7%|▋         | 745/10001 [00:00<00:02, 3670.65it/s] 11%|█▏        | 1130/10001 [00:00<00:02, 3720.11it/s] 15%|█▌        | 1505/10001 [00:00<00:02, 3726.76it/s] 19%|█▉        | 1889/10001 [00:00<00:02, 3758.23it/s] 23%|██▎       | 2271/10001 [00:00<00:02, 3773.50it/s] 27%|██▋       | 2663/10001 [00:00<00:01, 3814.03it/s] 30%|███       | 3041/10001 [00:00<00:01, 3802.41it/s] 34%|███▍      | 3415/10001 [00:00<00:01, 3782.26it/s] 38%|███▊      | 3812/10001 [00:01<00:01, 3835.75it/s] 42%|████▏     | 4201/10001 [00:01<00:01, 3851.86it/s] 46%|████▌     | 4589/10001 [00:01<00:01, 3858.65it/s] 50%|████▉     | 4979/10001 [00:01<00:01, 3868.53it/s] 54%|█████▎    | 5363/10001 [00:01<00:01, 3840.57it/s] 57%|█████▋    | 5748/10001 [00:01<00:01, 3842.84it/s] 61%|██████▏   | 6143/10001 [00:01<00:00, 3871.75it/s] 65%|██████▌   | 6545/10001 [00:01<00:00, 3914.84it/s] 69%|██████▉   | 6936/10001 [00:01<00:00, 3880.05it/s] 73%|███████▎  | 7325/10001 [00:01<00:00, 3881.55it/s] 77%|███████▋  | 7713/10001 [00:02<00:00, 3875.69it/s] 81%|████████  | 8101/10001 [00:02<00:00, 3838.07it/s] 85%|████████▍ | 8485/10001 [00:02<00:00, 3796.16it/s] 89%|████████▉ | 8876/10001 [00:02<00:00, 3827.73it/s] 93%|█████████▎| 9259/10001 [00:02<00:00, 3794.92it/s] 96%|█████████▋| 9643/10001 [00:02<00:00, 3807.37it/s]100%|██████████| 10001/10001 [00:02<00:00, 3827.83it/s]
  0%|          | 0/10001 [00:00<?, ?it/s]  4%|▍         | 388/10001 [00:00<00:02, 3875.78it/s]  8%|▊         | 774/10001 [00:00<00:02, 3870.48it/s] 12%|█▏        | 1167/10001 [00:00<00:02, 3888.07it/s] 16%|█▌        | 1563/10001 [00:00<00:02, 3907.60it/s] 20%|█▉        | 1966/10001 [00:00<00:02, 3942.42it/s] 23%|██▎       | 2350/10001 [00:00<00:01, 3908.72it/s] 27%|██▋       | 2738/10001 [00:00<00:01, 3899.77it/s] 31%|███       | 3122/10001 [00:00<00:01, 3878.58it/s] 35%|███▌      | 3504/10001 [00:00<00:01, 3857.88it/s] 39%|███▉      | 3893/10001 [00:01<00:01, 3865.70it/s] 43%|████▎     | 4288/10001 [00:01<00:01, 3889.13it/s] 47%|████▋     | 4675/10001 [00:01<00:01, 3881.68it/s] 51%|█████     | 5062/10001 [00:01<00:01, 3876.71it/s] 54%|█████▍    | 5450/10001 [00:01<00:01, 3875.34it/s] 58%|█████▊    | 5841/10001 [00:01<00:01, 3885.52it/s] 62%|██████▏   | 6234/10001 [00:01<00:00, 3898.59it/s] 66%|██████▋   | 6628/10001 [00:01<00:00, 3908.24it/s] 70%|███████   | 7022/10001 [00:01<00:00, 3915.63it/s] 74%|███████▍  | 7420/10001 [00:01<00:00, 3932.51it/s] 78%|███████▊  | 7818/10001 [00:02<00:00, 3946.60it/s] 82%|████████▏ | 8213/10001 [00:02<00:00, 3910.97it/s] 86%|████████▌ | 8604/10001 [00:02<00:00, 3844.21it/s] 90%|████████▉ | 8989/10001 [00:02<00:00, 3615.51it/s] 94%|█████████▍| 9391/10001 [00:02<00:00, 3727.06it/s] 98%|█████████▊| 9780/10001 [00:02<00:00, 3774.18it/s]100%|██████████| 10001/10001 [00:02<00:00, 3860.78it/s]2019-02-23 21:50:11.580600: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-02-23 21:50:11.757508: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:06:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2019-02-23 21:50:11.757549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-02-23 21:50:12.077102: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-02-23 21:50:12.077159: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-02-23 21:50:12.077167: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-02-23 21:50:12.077421: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10758 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:06:00.0, compute capability: 3.7)
41
[151, 439, 964, 1154, 1353, 1570, 1655, 2164, 2271, 2490, 2665, 3476, 3625, 3642, 3842, 4855, 4968, 4989, 5060, 5133, 5352, 5757, 5871, 5931, 6215, 6240, 6659, 6848, 6855, 6881, 6926, 7175, 7180, 7337, 7362, 7933, 7991, 8066, 8943, 9426, 10001]
45
[151, 439, 724, 964, 1154, 1353, 1570, 1655, 2164, 2271, 2490, 2665, 3476, 3625, 3642, 3842, 4855, 4968, 4989, 5060, 5133, 5352, 5757, 5871, 5931, 6031, 6215, 6240, 6659, 6848, 6855, 6881, 6926, 7175, 7180, 7337, 7362, 7933, 7991, 8066, 8884, 8943, 9426, 9603, 10001]
9960
9955
(15932, 512, 512, 1)
(3983, 512, 512, 1)
(15932, 2)
(3983, 2)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 510, 510, 1)       10        
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 2, 2, 64)          16581248  
_________________________________________________________________
flatten (Flatten)            (None, 256)               0         
_________________________________________________________________
dense (Dense)                (None, 2)                 514       
_________________________________________________________________
softmax (Softmax)            (None, 2)                 0         
=================================================================
Total params: 16,581,772
Trainable params: 16,581,772
Non-trainable params: 0
_________________________________________________________________
Train on 13542 samples, validate on 2390 samples
Epoch 1/40
 - 290s - loss: 0.7480 - categorical_accuracy: 0.4812 - val_loss: 0.7493 - val_categorical_accuracy: 0.4828
Epoch 2/40
 - 131s - loss: 0.7033 - categorical_accuracy: 0.4946 - val_loss: 0.7733 - val_categorical_accuracy: 0.4866
Epoch 3/40
 - 129s - loss: 0.6997 - categorical_accuracy: 0.5006 - val_loss: 0.7355 - val_categorical_accuracy: 0.4678
Epoch 4/40
 - 130s - loss: 0.6973 - categorical_accuracy: 0.5114 - val_loss: 0.7715 - val_categorical_accuracy: 0.4690
Epoch 5/40
 - 129s - loss: 0.6934 - categorical_accuracy: 0.5263 - val_loss: 0.7768 - val_categorical_accuracy: 0.4565
Epoch 6/40
 - 131s - loss: 0.6907 - categorical_accuracy: 0.5240 - val_loss: 0.7987 - val_categorical_accuracy: 0.4548
Epoch 7/40
 - 130s - loss: 0.6846 - categorical_accuracy: 0.5427 - val_loss: 0.7524 - val_categorical_accuracy: 0.3828
Epoch 8/40
 - 131s - loss: 0.6671 - categorical_accuracy: 0.5895 - val_loss: 0.8150 - val_categorical_accuracy: 0.4448
Epoch 9/40
 - 130s - loss: 0.6036 - categorical_accuracy: 0.7540 - val_loss: 0.6739 - val_categorical_accuracy: 0.6992
Epoch 10/40
 - 131s - loss: 0.4429 - categorical_accuracy: 0.8710 - val_loss: 0.5328 - val_categorical_accuracy: 0.7837
Epoch 11/40
 - 130s - loss: 0.2717 - categorical_accuracy: 0.9176 - val_loss: 0.3295 - val_categorical_accuracy: 0.8795
Epoch 12/40
 - 131s - loss: 0.1594 - categorical_accuracy: 0.9392 - val_loss: 0.2650 - val_categorical_accuracy: 0.9054
Epoch 13/40
 - 130s - loss: 0.1090 - categorical_accuracy: 0.9529 - val_loss: 0.2029 - val_categorical_accuracy: 0.9285
Epoch 14/40
 - 131s - loss: 0.0764 - categorical_accuracy: 0.9641 - val_loss: 0.1623 - val_categorical_accuracy: 0.9435
Epoch 15/40
 - 130s - loss: 0.0548 - categorical_accuracy: 0.9749 - val_loss: 0.1457 - val_categorical_accuracy: 0.9469
Epoch 16/40
 - 131s - loss: 0.0458 - categorical_accuracy: 0.9798 - val_loss: 0.1640 - val_categorical_accuracy: 0.9502
Epoch 17/40
 - 130s - loss: 0.0392 - categorical_accuracy: 0.9841 - val_loss: 0.1287 - val_categorical_accuracy: 0.9531
Epoch 18/40
 - 131s - loss: 0.0337 - categorical_accuracy: 0.9857 - val_loss: 0.1254 - val_categorical_accuracy: 0.9556
Epoch 19/40
 - 130s - loss: 0.0289 - categorical_accuracy: 0.9868 - val_loss: 0.1113 - val_categorical_accuracy: 0.9623
Epoch 20/40
 - 131s - loss: 0.0269 - categorical_accuracy: 0.9878 - val_loss: 0.1242 - val_categorical_accuracy: 0.9540
Epoch 21/40
 - 130s - loss: 0.0246 - categorical_accuracy: 0.9890 - val_loss: 0.1218 - val_categorical_accuracy: 0.9544
Epoch 22/40
 - 131s - loss: 0.0217 - categorical_accuracy: 0.9895 - val_loss: 0.1071 - val_categorical_accuracy: 0.9598
Epoch 23/40
 - 130s - loss: 0.0192 - categorical_accuracy: 0.9914 - val_loss: 0.1145 - val_categorical_accuracy: 0.9573
Epoch 24/40
 - 131s - loss: 0.0199 - categorical_accuracy: 0.9914 - val_loss: 0.0996 - val_categorical_accuracy: 0.9632
Epoch 25/40
 - 130s - loss: 0.0171 - categorical_accuracy: 0.9920 - val_loss: 0.1032 - val_categorical_accuracy: 0.9628
Epoch 26/40
 - 131s - loss: 0.0159 - categorical_accuracy: 0.9928 - val_loss: 0.0983 - val_categorical_accuracy: 0.9636
Epoch 27/40
 - 130s - loss: 0.0174 - categorical_accuracy: 0.9932 - val_loss: 0.0902 - val_categorical_accuracy: 0.9686
Epoch 28/40
 - 131s - loss: 0.0160 - categorical_accuracy: 0.9936 - val_loss: 0.0994 - val_categorical_accuracy: 0.9619
Epoch 29/40
 - 130s - loss: 0.0157 - categorical_accuracy: 0.9937 - val_loss: 0.1115 - val_categorical_accuracy: 0.9615
Epoch 30/40
 - 131s - loss: 0.0141 - categorical_accuracy: 0.9939 - val_loss: 0.0932 - val_categorical_accuracy: 0.9661
Epoch 31/40
 - 130s - loss: 0.0142 - categorical_accuracy: 0.9936 - val_loss: 0.0908 - val_categorical_accuracy: 0.9669
Epoch 32/40
 - 131s - loss: 0.0145 - categorical_accuracy: 0.9936 - val_loss: 0.0850 - val_categorical_accuracy: 0.9715
Epoch 33/40
 - 130s - loss: 0.0129 - categorical_accuracy: 0.9939 - val_loss: 0.0942 - val_categorical_accuracy: 0.9649
Epoch 34/40
 - 131s - loss: 0.0143 - categorical_accuracy: 0.9946 - val_loss: 0.0787 - val_categorical_accuracy: 0.9753
Epoch 35/40
 - 130s - loss: 0.0127 - categorical_accuracy: 0.9945 - val_loss: 0.0867 - val_categorical_accuracy: 0.9703
Epoch 36/40
 - 131s - loss: 0.0116 - categorical_accuracy: 0.9943 - val_loss: 0.0827 - val_categorical_accuracy: 0.9707
Epoch 37/40
 - 130s - loss: 0.0112 - categorical_accuracy: 0.9944 - val_loss: 0.0783 - val_categorical_accuracy: 0.9724
Epoch 38/40
 - 131s - loss: 0.0107 - categorical_accuracy: 0.9948 - val_loss: 0.0792 - val_categorical_accuracy: 0.9720
Epoch 39/40
 - 130s - loss: 0.0098 - categorical_accuracy: 0.9957 - val_loss: 0.0935 - val_categorical_accuracy: 0.9657
Epoch 40/40
 - 131s - loss: 0.0100 - categorical_accuracy: 0.9965 - val_loss: 0.0847 - val_categorical_accuracy: 0.9695

Using TensorFlow backend.

 Test accuracy: 0.9746422294752699
