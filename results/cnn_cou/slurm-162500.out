  0%|          | 0/10001 [00:00<?, ?it/s]  3%|▎         | 344/10001 [00:00<00:02, 3437.32it/s]  7%|▋         | 697/10001 [00:00<00:02, 3461.59it/s] 11%|█         | 1058/10001 [00:00<00:02, 3502.77it/s] 14%|█▍        | 1414/10001 [00:00<00:02, 3518.16it/s] 18%|█▊        | 1776/10001 [00:00<00:02, 3544.92it/s] 21%|██▏       | 2137/10001 [00:00<00:02, 3563.15it/s] 25%|██▍       | 2496/10001 [00:00<00:02, 3569.98it/s] 28%|██▊       | 2847/10001 [00:00<00:02, 3551.07it/s] 32%|███▏      | 3202/10001 [00:00<00:01, 3549.26it/s] 35%|███▌      | 3544/10001 [00:01<00:01, 3495.95it/s] 39%|███▉      | 3895/10001 [00:01<00:01, 3497.74it/s] 42%|████▏     | 4243/10001 [00:01<00:01, 3491.66it/s] 46%|████▌     | 4588/10001 [00:01<00:01, 3473.89it/s] 49%|████▉     | 4945/10001 [00:01<00:01, 3499.52it/s] 53%|█████▎    | 5302/10001 [00:01<00:01, 3517.57it/s] 57%|█████▋    | 5653/10001 [00:01<00:01, 3506.14it/s] 60%|██████    | 6003/10001 [00:01<00:01, 3483.94it/s] 64%|██████▎   | 6351/10001 [00:01<00:01, 3464.76it/s] 67%|██████▋   | 6699/10001 [00:01<00:00, 3469.19it/s] 71%|███████   | 7071/10001 [00:02<00:00, 3538.42it/s] 74%|███████▍  | 7425/10001 [00:02<00:00, 3520.53it/s] 78%|███████▊  | 7778/10001 [00:02<00:00, 3484.28it/s] 81%|████████▏ | 8129/10001 [00:02<00:00, 3490.96it/s] 85%|████████▍ | 8480/10001 [00:02<00:00, 3495.45it/s] 88%|████████▊ | 8837/10001 [00:02<00:00, 3516.28it/s] 92%|█████████▏| 9189/10001 [00:02<00:00, 3516.94it/s] 95%|█████████▌| 9541/10001 [00:02<00:00, 3489.22it/s] 99%|█████████▉| 9911/10001 [00:02<00:00, 3547.84it/s]100%|██████████| 10001/10001 [00:02<00:00, 3517.82it/s]
  0%|          | 0/10001 [00:00<?, ?it/s]  4%|▍         | 379/10001 [00:00<00:02, 3780.97it/s]  7%|▋         | 738/10001 [00:00<00:02, 3719.11it/s] 11%|█         | 1105/10001 [00:00<00:02, 3702.45it/s] 15%|█▍        | 1458/10001 [00:00<00:02, 3648.19it/s] 18%|█▊        | 1810/10001 [00:00<00:02, 3607.17it/s] 22%|██▏       | 2158/10001 [00:00<00:02, 3565.85it/s] 25%|██▌       | 2506/10001 [00:00<00:02, 3536.72it/s] 29%|██▊       | 2875/10001 [00:00<00:01, 3579.23it/s] 32%|███▏      | 3227/10001 [00:00<00:01, 3558.36it/s] 36%|███▌      | 3577/10001 [00:01<00:01, 3539.27it/s] 39%|███▉      | 3934/10001 [00:01<00:01, 3546.94it/s] 43%|████▎     | 4299/10001 [00:01<00:01, 3576.66it/s] 47%|████▋     | 4662/10001 [00:01<00:01, 3592.13it/s] 50%|█████     | 5025/10001 [00:01<00:01, 3600.26it/s] 54%|█████▍    | 5383/10001 [00:01<00:01, 3570.29it/s] 57%|█████▋    | 5739/10001 [00:01<00:01, 3547.27it/s] 61%|██████    | 6093/10001 [00:01<00:01, 3528.60it/s] 64%|██████▍   | 6449/10001 [00:01<00:01, 3536.24it/s] 68%|██████▊   | 6819/10001 [00:01<00:00, 3581.14it/s] 72%|███████▏  | 7190/10001 [00:02<00:00, 3617.58it/s] 76%|███████▌  | 7560/10001 [00:02<00:00, 3639.67it/s] 79%|███████▉  | 7924/10001 [00:02<00:00, 3575.79it/s] 83%|████████▎ | 8287/10001 [00:02<00:00, 3590.58it/s] 86%|████████▋ | 8647/10001 [00:02<00:00, 3585.83it/s] 90%|█████████ | 9006/10001 [00:02<00:00, 3562.05it/s] 94%|█████████▎| 9372/10001 [00:02<00:00, 3588.13it/s] 97%|█████████▋| 9744/10001 [00:02<00:00, 3625.27it/s]100%|██████████| 10001/10001 [00:02<00:00, 3583.45it/s]2019-03-01 19:08:45.942944: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-03-01 19:08:46.119824: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:06:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2019-03-01 19:08:46.119867: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-01 19:08:46.440711: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-01 19:08:46.440756: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-01 19:08:46.440762: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-01 19:08:46.441018: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10758 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:06:00.0, compute capability: 3.7)
41
[151, 439, 964, 1154, 1353, 1570, 1655, 2164, 2271, 2490, 2665, 3476, 3625, 3642, 3842, 4855, 4968, 4989, 5060, 5133, 5352, 5757, 5871, 5931, 6215, 6240, 6659, 6848, 6855, 6881, 6926, 7175, 7180, 7337, 7362, 7933, 7991, 8066, 8943, 9426, 10001]
41
[151, 439, 964, 1154, 1353, 1570, 1655, 2164, 2271, 2490, 2665, 3476, 3625, 3642, 3842, 4855, 4968, 4989, 5133, 5352, 5757, 5871, 5931, 6215, 6240, 6659, 6848, 6855, 6926, 7175, 7180, 7337, 7362, 7933, 7991, 8066, 8943, 9426, 9603, 9712, 10001]
9960
9959
(15935, 512, 512, 1)
(3984, 512, 512, 1)
(15935, 2)
(3984, 2)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 510, 510, 1)       10        
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 2, 2, 64)          16581248  
_________________________________________________________________
flatten (Flatten)            (None, 256)               0         
_________________________________________________________________
dense (Dense)                (None, 2)                 514       
_________________________________________________________________
softmax (Softmax)            (None, 2)                 0         
=================================================================
Total params: 16,581,772
Trainable params: 16,581,772
Non-trainable params: 0
_________________________________________________________________
Train on 13544 samples, validate on 2391 samples
Epoch 1/40
 - 293s - loss: 0.7582 - categorical_accuracy: 0.4878 - val_loss: 0.7412 - val_categorical_accuracy: 0.4780
Epoch 2/40
 - 135s - loss: 0.7089 - categorical_accuracy: 0.4899 - val_loss: 0.7091 - val_categorical_accuracy: 0.4437
Epoch 3/40
 - 134s - loss: 0.7026 - categorical_accuracy: 0.4949 - val_loss: 0.7164 - val_categorical_accuracy: 0.4417
Epoch 4/40
 - 135s - loss: 0.7008 - categorical_accuracy: 0.5020 - val_loss: 0.7416 - val_categorical_accuracy: 0.4463
Epoch 5/40
 - 134s - loss: 0.6965 - categorical_accuracy: 0.5109 - val_loss: 0.7457 - val_categorical_accuracy: 0.4617
Epoch 6/40
 - 135s - loss: 0.6955 - categorical_accuracy: 0.5137 - val_loss: 0.7510 - val_categorical_accuracy: 0.4266
Epoch 7/40
 - 134s - loss: 0.6910 - categorical_accuracy: 0.5238 - val_loss: 0.7480 - val_categorical_accuracy: 0.3839
Epoch 8/40
 - 135s - loss: 0.6882 - categorical_accuracy: 0.5330 - val_loss: 0.7655 - val_categorical_accuracy: 0.3772
Epoch 9/40
 - 134s - loss: 0.6872 - categorical_accuracy: 0.5298 - val_loss: 0.7663 - val_categorical_accuracy: 0.3568
Epoch 10/40
 - 135s - loss: 0.6851 - categorical_accuracy: 0.5300 - val_loss: 0.8025 - val_categorical_accuracy: 0.3898
Epoch 11/40
 - 134s - loss: 0.6831 - categorical_accuracy: 0.5352 - val_loss: 0.8083 - val_categorical_accuracy: 0.3082
Epoch 12/40
 - 135s - loss: 0.6786 - categorical_accuracy: 0.5457 - val_loss: 0.8240 - val_categorical_accuracy: 0.3580
Epoch 13/40
 - 134s - loss: 0.6750 - categorical_accuracy: 0.5461 - val_loss: 0.8521 - val_categorical_accuracy: 0.3492
Epoch 14/40
 - 135s - loss: 0.6737 - categorical_accuracy: 0.5488 - val_loss: 0.8606 - val_categorical_accuracy: 0.3304
Epoch 15/40
 - 134s - loss: 0.6679 - categorical_accuracy: 0.5598 - val_loss: 0.8874 - val_categorical_accuracy: 0.2953
Epoch 16/40
 - 135s - loss: 0.6670 - categorical_accuracy: 0.5521 - val_loss: 0.9220 - val_categorical_accuracy: 0.2882
Epoch 17/40
 - 134s - loss: 0.6604 - categorical_accuracy: 0.5673 - val_loss: 0.9974 - val_categorical_accuracy: 0.3597
Epoch 18/40
 - 135s - loss: 0.6566 - categorical_accuracy: 0.5675 - val_loss: 0.9959 - val_categorical_accuracy: 0.3927
Epoch 19/40
 - 134s - loss: 0.6565 - categorical_accuracy: 0.5771 - val_loss: 0.9792 - val_categorical_accuracy: 0.3756
Epoch 20/40
 - 135s - loss: 0.6439 - categorical_accuracy: 0.5831 - val_loss: 1.0057 - val_categorical_accuracy: 0.3061
Epoch 21/40
 - 134s - loss: 0.6368 - categorical_accuracy: 0.5871 - val_loss: 1.0058 - val_categorical_accuracy: 0.2823
Epoch 22/40
 - 135s - loss: 0.6311 - categorical_accuracy: 0.5863 - val_loss: 1.0551 - val_categorical_accuracy: 0.2509
Epoch 23/40
 - 134s - loss: 0.6317 - categorical_accuracy: 0.6076 - val_loss: 1.0424 - val_categorical_accuracy: 0.3032
Epoch 24/40
 - 135s - loss: 0.6178 - categorical_accuracy: 0.6096 - val_loss: 1.2003 - val_categorical_accuracy: 0.3032
Epoch 25/40
 - 134s - loss: 0.6225 - categorical_accuracy: 0.6116 - val_loss: 1.0461 - val_categorical_accuracy: 0.2509
Epoch 26/40
 - 135s - loss: 0.6128 - categorical_accuracy: 0.6179 - val_loss: 1.2708 - val_categorical_accuracy: 0.3133
Epoch 27/40
 - 134s - loss: 0.6049 - categorical_accuracy: 0.6276 - val_loss: 1.0557 - val_categorical_accuracy: 0.3944
Epoch 28/40
 - 135s - loss: 0.5906 - categorical_accuracy: 0.6431 - val_loss: 1.2619 - val_categorical_accuracy: 0.2957
Epoch 29/40
 - 133s - loss: 0.5899 - categorical_accuracy: 0.6484 - val_loss: 1.3569 - val_categorical_accuracy: 0.2217
Epoch 30/40
 - 135s - loss: 0.5742 - categorical_accuracy: 0.6621 - val_loss: 0.9093 - val_categorical_accuracy: 0.2200
Epoch 31/40
 - 134s - loss: 0.5645 - categorical_accuracy: 0.6732 - val_loss: 1.1196 - val_categorical_accuracy: 0.2158
Epoch 32/40
 - 135s - loss: 0.5573 - categorical_accuracy: 0.6830 - val_loss: 1.3750 - val_categorical_accuracy: 0.2284
Epoch 33/40
 - 133s - loss: 0.5487 - categorical_accuracy: 0.6981 - val_loss: 1.3722 - val_categorical_accuracy: 0.2497
Epoch 34/40
 - 135s - loss: 0.5346 - categorical_accuracy: 0.7097 - val_loss: 1.1757 - val_categorical_accuracy: 0.2355
Epoch 35/40
 - 134s - loss: 0.5288 - categorical_accuracy: 0.7199 - val_loss: 1.3939 - val_categorical_accuracy: 0.2601
Epoch 36/40
 - 135s - loss: 0.5146 - categorical_accuracy: 0.7325 - val_loss: 1.6669 - val_categorical_accuracy: 0.2647
Epoch 37/40
 - 134s - loss: 0.4985 - categorical_accuracy: 0.7457 - val_loss: 1.5968 - val_categorical_accuracy: 0.2350
Epoch 38/40
 - 133s - loss: 0.4820 - categorical_accuracy: 0.7645 - val_loss: 1.5623 - val_categorical_accuracy: 0.2652
Epoch 39/40
 - 131s - loss: 0.4693 - categorical_accuracy: 0.7704 - val_loss: 1.7208 - val_categorical_accuracy: 0.2735
Epoch 40/40
 - 132s - loss: 0.4487 - categorical_accuracy: 0.7831 - val_loss: 2.0024 - val_categorical_accuracy: 0.2706

Using TensorFlow backend.

 Test accuracy: 0.2833835341365462
  0%|          | 0/10001 [00:00<?, ?it/s]  4%|▎         | 352/10001 [00:00<00:02, 3515.77it/s]  7%|▋         | 691/10001 [00:00<00:02, 3474.84it/s] 10%|█         | 1025/10001 [00:00<00:02, 3431.74it/s] 14%|█▍        | 1380/10001 [00:00<00:02, 3463.51it/s] 17%|█▋        | 1744/10001 [00:00<00:02, 3513.82it/s] 21%|██        | 2109/10001 [00:00<00:02, 3552.33it/s] 25%|██▍       | 2464/10001 [00:00<00:02, 3549.93it/s] 28%|██▊       | 2817/10001 [00:00<00:02, 3541.08it/s] 32%|███▏      | 3167/10001 [00:00<00:01, 3525.90it/s] 35%|███▌      | 3506/10001 [00:01<00:01, 3448.51it/s] 39%|███▊      | 3852/10001 [00:01<00:01, 3450.57it/s] 42%|████▏     | 4204/10001 [00:01<00:01, 3469.78it/s] 45%|████▌     | 4547/10001 [00:01<00:01, 3439.46it/s] 49%|████▉     | 4889/10001 [00:01<00:01, 3433.21it/s] 53%|█████▎    | 5258/10001 [00:01<00:01, 3505.65it/s] 56%|█████▌    | 5608/10001 [00:01<00:01, 3498.18it/s] 60%|█████▉    | 5967/10001 [00:01<00:01, 3522.85it/s] 63%|██████▎   | 6319/10001 [00:01<00:01, 3512.05it/s] 67%|██████▋   | 6679/10001 [00:01<00:00, 3536.28it/s] 70%|███████   | 7033/10001 [00:02<00:00, 3499.79it/s] 74%|███████▍  | 7386/10001 [00:02<00:00, 3505.69it/s] 77%|███████▋  | 7737/10001 [00:02<00:00, 3487.28it/s] 81%|████████  | 8086/10001 [00:02<00:00, 3446.72it/s] 85%|████████▍ | 8455/10001 [00:02<00:00, 3514.04it/s] 88%|████████▊ | 8825/10001 [00:02<00:00, 3567.13it/s] 92%|█████████▏| 9183/10001 [00:02<00:00, 3550.78it/s] 95%|█████████▌| 9539/10001 [00:02<00:00, 3527.56it/s] 99%|█████████▉| 9894/10001 [00:02<00:00, 3532.29it/s]100%|██████████| 10001/10001 [00:02<00:00, 3503.19it/s]
  0%|          | 0/10001 [00:00<?, ?it/s]  3%|▎         | 349/10001 [00:00<00:02, 3481.26it/s]  7%|▋         | 692/10001 [00:00<00:02, 3464.00it/s] 10%|█         | 1050/10001 [00:00<00:02, 3495.82it/s] 14%|█▍        | 1405/10001 [00:00<00:02, 3509.90it/s] 18%|█▊        | 1752/10001 [00:00<00:02, 3496.26it/s] 21%|██        | 2108/10001 [00:00<00:02, 3513.45it/s] 25%|██▍       | 2479/10001 [00:00<00:02, 3570.10it/s] 28%|██▊       | 2848/10001 [00:00<00:01, 3603.48it/s] 32%|███▏      | 3214/10001 [00:00<00:01, 3619.43it/s] 36%|███▌      | 3599/10001 [00:01<00:01, 3683.18it/s] 40%|███▉      | 3969/10001 [00:01<00:01, 3685.44it/s] 43%|████▎     | 4336/10001 [00:01<00:01, 3680.73it/s] 47%|████▋     | 4721/10001 [00:01<00:01, 3728.76it/s] 51%|█████     | 5092/10001 [00:01<00:01, 3721.81it/s] 55%|█████▍    | 5463/10001 [00:01<00:01, 3711.45it/s] 58%|█████▊    | 5833/10001 [00:01<00:01, 3654.73it/s] 62%|██████▏   | 6198/10001 [00:01<00:01, 3623.64it/s] 66%|██████▌   | 6560/10001 [00:01<00:00, 3498.71it/s] 69%|██████▉   | 6911/10001 [00:01<00:00, 3396.44it/s] 73%|███████▎  | 7252/10001 [00:02<00:00, 3314.51it/s] 76%|███████▌  | 7585/10001 [00:02<00:00, 3295.46it/s] 79%|███████▉  | 7916/10001 [00:02<00:00, 3223.68it/s] 82%|████████▏ | 8248/10001 [00:02<00:00, 3250.21it/s] 86%|████████▌ | 8590/10001 [00:02<00:00, 3296.71it/s] 89%|████████▉ | 8921/10001 [00:02<00:00, 3282.59it/s] 93%|█████████▎| 9258/10001 [00:02<00:00, 3306.67it/s] 96%|█████████▌| 9590/10001 [00:02<00:00, 3240.24it/s] 99%|█████████▉| 9915/10001 [00:02<00:00, 3218.03it/s]100%|██████████| 10001/10001 [00:02<00:00, 3460.10it/s]2019-03-01 20:42:25.416281: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-03-01 20:42:25.593299: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:06:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2019-03-01 20:42:25.593337: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-01 20:42:25.915002: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-01 20:42:25.915049: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-01 20:42:25.915057: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-01 20:42:25.915318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10758 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:06:00.0, compute capability: 3.7)
41
[151, 439, 964, 1154, 1353, 1570, 1655, 2164, 2271, 2490, 2665, 3476, 3625, 3642, 3842, 4855, 4968, 4989, 5060, 5133, 5352, 5757, 5871, 5931, 6215, 6240, 6659, 6848, 6855, 6881, 6926, 7175, 7180, 7337, 7362, 7933, 7991, 8066, 8943, 9426, 10001]
42
[151, 439, 964, 1154, 1353, 1570, 1655, 2164, 2271, 2490, 2665, 3476, 3625, 3642, 3842, 4136, 4855, 4968, 4989, 5060, 5133, 5352, 5757, 5871, 5931, 6215, 6240, 6659, 6848, 6855, 6881, 6926, 7175, 7180, 7337, 7933, 7991, 8066, 8943, 9125, 9426, 10001]
9960
9958
(15934, 512, 512, 1)
(3984, 512, 512, 1)
(15934, 2)
(3984, 2)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 510, 510, 1)       10        
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 2, 2, 64)          16581248  
_________________________________________________________________
flatten (Flatten)            (None, 256)               0         
_________________________________________________________________
dense (Dense)                (None, 2)                 514       
_________________________________________________________________
softmax (Softmax)            (None, 2)                 0         
=================================================================
Total params: 16,581,772
Trainable params: 16,581,772
Non-trainable params: 0
_________________________________________________________________
Train on 13543 samples, validate on 2391 samples
Epoch 1/40
 - 293s - loss: 0.7682 - categorical_accuracy: 0.4839 - val_loss: 0.7235 - val_categorical_accuracy: 0.4852
Epoch 2/40
 - 135s - loss: 0.7063 - categorical_accuracy: 0.4848 - val_loss: 0.7223 - val_categorical_accuracy: 0.4789
Epoch 3/40
 - 134s - loss: 0.7016 - categorical_accuracy: 0.5008 - val_loss: 0.7294 - val_categorical_accuracy: 0.3885
Epoch 4/40
 - 135s - loss: 0.6978 - categorical_accuracy: 0.5074 - val_loss: 0.7599 - val_categorical_accuracy: 0.4542
Epoch 5/40
 - 134s - loss: 0.6929 - categorical_accuracy: 0.5243 - val_loss: 0.7529 - val_categorical_accuracy: 0.4329
Epoch 6/40
 - 135s - loss: 0.6933 - categorical_accuracy: 0.5225 - val_loss: 0.7863 - val_categorical_accuracy: 0.4262
Epoch 7/40
 - 134s - loss: 0.6889 - categorical_accuracy: 0.5268 - val_loss: 0.8244 - val_categorical_accuracy: 0.4437
Epoch 8/40
 - 135s - loss: 0.6851 - categorical_accuracy: 0.5315 - val_loss: 0.8375 - val_categorical_accuracy: 0.4295
Epoch 9/40
 - 134s - loss: 0.6807 - categorical_accuracy: 0.5420 - val_loss: 0.8546 - val_categorical_accuracy: 0.4111
Epoch 10/40
 - 135s - loss: 0.6778 - categorical_accuracy: 0.5335 - val_loss: 0.8604 - val_categorical_accuracy: 0.3379
Epoch 11/40
 - 134s - loss: 0.6744 - categorical_accuracy: 0.5415 - val_loss: 0.8877 - val_categorical_accuracy: 0.3417
Epoch 12/40
 - 135s - loss: 0.6697 - categorical_accuracy: 0.5446 - val_loss: 0.8961 - val_categorical_accuracy: 0.2647
Epoch 13/40
 - 134s - loss: 0.6667 - categorical_accuracy: 0.5443 - val_loss: 0.9353 - val_categorical_accuracy: 0.2547
Epoch 14/40
 - 135s - loss: 0.6585 - categorical_accuracy: 0.5469 - val_loss: 0.9739 - val_categorical_accuracy: 0.2995
Epoch 15/40
 - 134s - loss: 0.6515 - categorical_accuracy: 0.5593 - val_loss: 1.0257 - val_categorical_accuracy: 0.3384
Epoch 16/40
 - 135s - loss: 0.6468 - categorical_accuracy: 0.5536 - val_loss: 1.0400 - val_categorical_accuracy: 0.2944
Epoch 17/40
 - 134s - loss: 0.6415 - categorical_accuracy: 0.5610 - val_loss: 1.0349 - val_categorical_accuracy: 0.3057
Epoch 18/40
 - 135s - loss: 0.6344 - categorical_accuracy: 0.5689 - val_loss: 1.1065 - val_categorical_accuracy: 0.2765
Epoch 19/40
 - 134s - loss: 0.6300 - categorical_accuracy: 0.5678 - val_loss: 1.1683 - val_categorical_accuracy: 0.2710
Epoch 20/40
 - 135s - loss: 0.6237 - categorical_accuracy: 0.5689 - val_loss: 1.2280 - val_categorical_accuracy: 0.2091
Epoch 21/40
 - 134s - loss: 0.6187 - categorical_accuracy: 0.5713 - val_loss: 1.2316 - val_categorical_accuracy: 0.2221
Epoch 22/40
 - 135s - loss: 0.6158 - categorical_accuracy: 0.5737 - val_loss: 1.2902 - val_categorical_accuracy: 0.2564
Epoch 23/40
 - 134s - loss: 0.6100 - categorical_accuracy: 0.5723 - val_loss: 1.2629 - val_categorical_accuracy: 0.2033
Epoch 24/40
 - 135s - loss: 0.6062 - categorical_accuracy: 0.5694 - val_loss: 1.3853 - val_categorical_accuracy: 0.2355
Epoch 25/40
 - 134s - loss: 0.6010 - categorical_accuracy: 0.5685 - val_loss: 1.4130 - val_categorical_accuracy: 0.2488
Epoch 26/40
 - 135s - loss: 0.6019 - categorical_accuracy: 0.5713 - val_loss: 1.4058 - val_categorical_accuracy: 0.1924
Epoch 27/40
 - 134s - loss: 0.5941 - categorical_accuracy: 0.5768 - val_loss: 1.5113 - val_categorical_accuracy: 0.2614
Epoch 28/40
 - 135s - loss: 0.5914 - categorical_accuracy: 0.5840 - val_loss: 1.4762 - val_categorical_accuracy: 0.2079
Epoch 29/40
 - 134s - loss: 0.5869 - categorical_accuracy: 0.5834 - val_loss: 1.5207 - val_categorical_accuracy: 0.2171
Epoch 30/40
 - 135s - loss: 0.5879 - categorical_accuracy: 0.5766 - val_loss: 1.5717 - val_categorical_accuracy: 0.2041
Epoch 31/40
 - 134s - loss: 0.5833 - categorical_accuracy: 0.5793 - val_loss: 1.6128 - val_categorical_accuracy: 0.1890
Epoch 32/40
 - 135s - loss: 0.5813 - categorical_accuracy: 0.5793 - val_loss: 1.6494 - val_categorical_accuracy: 0.2288
Epoch 33/40
 - 134s - loss: 0.5792 - categorical_accuracy: 0.5776 - val_loss: 1.6964 - val_categorical_accuracy: 0.2049
Epoch 34/40
 - 135s - loss: 0.5728 - categorical_accuracy: 0.5883 - val_loss: 1.6851 - val_categorical_accuracy: 0.1924
Epoch 35/40
 - 134s - loss: 0.5701 - categorical_accuracy: 0.5895 - val_loss: 1.7113 - val_categorical_accuracy: 0.2150
Epoch 36/40
 - 135s - loss: 0.5707 - categorical_accuracy: 0.5787 - val_loss: 1.7199 - val_categorical_accuracy: 0.2095
Epoch 37/40
 - 134s - loss: 0.5660 - categorical_accuracy: 0.5912 - val_loss: 1.8285 - val_categorical_accuracy: 0.2079
Epoch 38/40
 - 134s - loss: 0.5662 - categorical_accuracy: 0.5954 - val_loss: 1.7638 - val_categorical_accuracy: 0.2037
Epoch 39/40
 - 131s - loss: 0.5620 - categorical_accuracy: 0.5942 - val_loss: 1.8414 - val_categorical_accuracy: 0.2041
Epoch 40/40
 - 132s - loss: 0.5612 - categorical_accuracy: 0.5887 - val_loss: 1.8270 - val_categorical_accuracy: 0.2095

Using TensorFlow backend.

 Test accuracy: 0.21059236947791166
  0%|          | 0/10001 [00:00<?, ?it/s]  3%|▎         | 350/10001 [00:00<00:02, 3494.95it/s]  7%|▋         | 703/10001 [00:00<00:02, 3505.14it/s] 10%|█         | 1050/10001 [00:00<00:02, 3494.19it/s] 14%|█▍        | 1432/10001 [00:00<00:02, 3583.79it/s] 18%|█▊        | 1807/10001 [00:00<00:02, 3629.57it/s] 22%|██▏       | 2168/10001 [00:00<00:02, 3623.20it/s] 25%|██▌       | 2525/10001 [00:00<00:02, 3604.75it/s] 29%|██▉       | 2896/10001 [00:00<00:01, 3634.59it/s] 33%|███▎      | 3271/10001 [00:00<00:01, 3668.30it/s] 37%|███▋      | 3659/10001 [00:01<00:01, 3727.08it/s] 40%|████      | 4032/10001 [00:01<00:01, 3727.16it/s] 44%|████▍     | 4399/10001 [00:01<00:01, 3698.57it/s] 48%|████▊     | 4765/10001 [00:01<00:01, 3670.19it/s] 51%|█████▏    | 5144/10001 [00:01<00:01, 3705.10it/s] 55%|█████▌    | 5513/10001 [00:01<00:01, 3683.83it/s] 59%|█████▉    | 5880/10001 [00:01<00:01, 3661.60it/s] 63%|██████▎   | 6253/10001 [00:01<00:01, 3680.47it/s] 66%|██████▋   | 6636/10001 [00:01<00:00, 3722.29it/s] 70%|███████   | 7016/10001 [00:01<00:00, 3743.70it/s] 74%|███████▍  | 7395/10001 [00:02<00:00, 3754.96it/s] 78%|███████▊  | 7771/10001 [00:02<00:00, 3751.74it/s] 81%|████████▏ | 8147/10001 [00:02<00:00, 3663.15it/s] 85%|████████▌ | 8524/10001 [00:02<00:00, 3694.50it/s] 89%|████████▉ | 8894/10001 [00:02<00:00, 3672.84it/s] 93%|█████████▎| 9262/10001 [00:02<00:00, 3668.01it/s] 96%|█████████▋| 9629/10001 [00:02<00:00, 3658.45it/s]100%|██████████| 10001/10001 [00:02<00:00, 3679.42it/s]
  0%|          | 0/10001 [00:00<?, ?it/s]  4%|▎         | 359/10001 [00:00<00:02, 3586.25it/s]  7%|▋         | 736/10001 [00:00<00:02, 3637.51it/s] 11%|█         | 1122/10001 [00:00<00:02, 3701.14it/s] 15%|█▍        | 1494/10001 [00:00<00:02, 3703.82it/s] 19%|█▊        | 1856/10001 [00:00<00:02, 3675.88it/s] 22%|██▏       | 2220/10001 [00:00<00:02, 3662.48it/s] 26%|██▌       | 2600/10001 [00:00<00:01, 3701.07it/s] 30%|██▉       | 2966/10001 [00:00<00:01, 3688.15it/s] 33%|███▎      | 3317/10001 [00:00<00:01, 3631.60it/s] 37%|███▋      | 3696/10001 [00:01<00:01, 3675.75it/s] 41%|████      | 4062/10001 [00:01<00:01, 3670.07it/s] 44%|████▍     | 4433/10001 [00:01<00:01, 3680.10it/s] 48%|████▊     | 4797/10001 [00:01<00:01, 3550.96it/s] 51%|█████▏    | 5150/10001 [00:01<00:01, 3326.38it/s] 55%|█████▍    | 5484/10001 [00:01<00:01, 3293.19it/s] 58%|█████▊    | 5815/10001 [00:01<00:01, 3281.99it/s] 62%|██████▏   | 6161/10001 [00:01<00:01, 3330.85it/s] 65%|██████▍   | 6499/10001 [00:01<00:01, 3345.17it/s] 68%|██████▊   | 6850/10001 [00:01<00:00, 3391.55it/s] 72%|███████▏  | 7197/10001 [00:02<00:00, 3411.92it/s] 76%|███████▌  | 7559/10001 [00:02<00:00, 3469.07it/s] 79%|███████▉  | 7907/10001 [00:02<00:00, 3434.52it/s] 83%|████████▎ | 8270/10001 [00:02<00:00, 3489.18it/s] 86%|████████▌ | 8620/10001 [00:02<00:00, 3440.87it/s] 90%|████████▉ | 8965/10001 [00:02<00:00, 3424.92it/s] 93%|█████████▎| 9317/10001 [00:02<00:00, 3452.39it/s] 97%|█████████▋| 9663/10001 [00:02<00:00, 3431.24it/s]100%|██████████| 10001/10001 [00:02<00:00, 3507.38it/s]2019-03-01 22:16:10.807749: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-03-01 22:16:10.984454: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:06:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2019-03-01 22:16:10.984496: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-01 22:16:11.307732: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-01 22:16:11.307777: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-01 22:16:11.307783: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-01 22:16:11.308033: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10758 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:06:00.0, compute capability: 3.7)
41
[151, 439, 964, 1154, 1353, 1570, 1655, 2164, 2271, 2490, 2665, 3476, 3625, 3642, 3842, 4855, 4968, 4989, 5060, 5133, 5352, 5757, 5871, 5931, 6215, 6240, 6659, 6848, 6855, 6881, 6926, 7175, 7180, 7337, 7362, 7933, 7991, 8066, 8943, 9426, 10001]
46
[151, 439, 964, 1070, 1154, 1353, 1570, 1655, 2164, 2271, 2490, 2665, 3476, 3625, 3642, 3842, 4136, 4855, 4968, 4989, 5060, 5133, 5265, 5352, 5757, 5871, 5931, 6123, 6215, 6240, 6659, 6855, 6926, 7175, 7337, 7362, 7933, 7985, 7991, 8066, 8884, 8943, 9426, 9603, 9712, 10001]
9960
9954
(15931, 512, 512, 1)
(3983, 512, 512, 1)
(15931, 2)
(3983, 2)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 510, 510, 1)       10        
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 2, 2, 64)          16581248  
_________________________________________________________________
flatten (Flatten)            (None, 256)               0         
_________________________________________________________________
dense (Dense)                (None, 2)                 514       
_________________________________________________________________
softmax (Softmax)            (None, 2)                 0         
=================================================================
Total params: 16,581,772
Trainable params: 16,581,772
Non-trainable params: 0
_________________________________________________________________
Train on 13541 samples, validate on 2390 samples
Epoch 1/40
 - 293s - loss: 0.7763 - categorical_accuracy: 0.4800 - val_loss: 0.8051 - val_categorical_accuracy: 0.4849
Epoch 2/40
 - 133s - loss: 0.7033 - categorical_accuracy: 0.5004 - val_loss: 0.7572 - val_categorical_accuracy: 0.4791
Epoch 3/40
 - 134s - loss: 0.7025 - categorical_accuracy: 0.4958 - val_loss: 0.8081 - val_categorical_accuracy: 0.4887
Epoch 4/40
 - 133s - loss: 0.7018 - categorical_accuracy: 0.5027 - val_loss: 0.7908 - val_categorical_accuracy: 0.4757
Epoch 5/40
 - 134s - loss: 0.6972 - categorical_accuracy: 0.5121 - val_loss: 0.7485 - val_categorical_accuracy: 0.4640
Epoch 6/40
 - 133s - loss: 0.6971 - categorical_accuracy: 0.5116 - val_loss: 0.7598 - val_categorical_accuracy: 0.4690
Epoch 7/40
 - 134s - loss: 0.6957 - categorical_accuracy: 0.5130 - val_loss: 0.7831 - val_categorical_accuracy: 0.4803
Epoch 8/40
 - 133s - loss: 0.6948 - categorical_accuracy: 0.5173 - val_loss: 0.7702 - val_categorical_accuracy: 0.4690
Epoch 9/40
 - 134s - loss: 0.6937 - categorical_accuracy: 0.5147 - val_loss: 0.8049 - val_categorical_accuracy: 0.4766
Epoch 10/40
 - 133s - loss: 0.6936 - categorical_accuracy: 0.5144 - val_loss: 0.7667 - val_categorical_accuracy: 0.4402
Epoch 11/40
 - 134s - loss: 0.6924 - categorical_accuracy: 0.5234 - val_loss: 0.7876 - val_categorical_accuracy: 0.4389
Epoch 12/40
 - 133s - loss: 0.6918 - categorical_accuracy: 0.5229 - val_loss: 0.7926 - val_categorical_accuracy: 0.4477
Epoch 13/40
 - 134s - loss: 0.6910 - categorical_accuracy: 0.5236 - val_loss: 0.7852 - val_categorical_accuracy: 0.4594
Epoch 14/40
 - 133s - loss: 0.6895 - categorical_accuracy: 0.5274 - val_loss: 0.8061 - val_categorical_accuracy: 0.4498
Epoch 15/40
 - 134s - loss: 0.6896 - categorical_accuracy: 0.5268 - val_loss: 0.7815 - val_categorical_accuracy: 0.4226
Epoch 16/40
 - 133s - loss: 0.6906 - categorical_accuracy: 0.5222 - val_loss: 0.8199 - val_categorical_accuracy: 0.4293
Epoch 17/40
 - 134s - loss: 0.6893 - categorical_accuracy: 0.5223 - val_loss: 0.7824 - val_categorical_accuracy: 0.4347
Epoch 18/40
 - 133s - loss: 0.6877 - categorical_accuracy: 0.5265 - val_loss: 0.8331 - val_categorical_accuracy: 0.4439
Epoch 19/40
 - 134s - loss: 0.6845 - categorical_accuracy: 0.5377 - val_loss: 0.7913 - val_categorical_accuracy: 0.4138
Epoch 20/40
 - 133s - loss: 0.6853 - categorical_accuracy: 0.5379 - val_loss: 0.8662 - val_categorical_accuracy: 0.4477
Epoch 21/40
 - 134s - loss: 0.6846 - categorical_accuracy: 0.5351 - val_loss: 0.8468 - val_categorical_accuracy: 0.4410
Epoch 22/40
 - 133s - loss: 0.6848 - categorical_accuracy: 0.5311 - val_loss: 0.7991 - val_categorical_accuracy: 0.4130
Epoch 23/40
 - 134s - loss: 0.6856 - categorical_accuracy: 0.5370 - val_loss: 0.8271 - val_categorical_accuracy: 0.4126
Epoch 24/40
 - 133s - loss: 0.6844 - categorical_accuracy: 0.5353 - val_loss: 0.7869 - val_categorical_accuracy: 0.4197
Epoch 25/40
 - 133s - loss: 0.6842 - categorical_accuracy: 0.5367 - val_loss: 0.7937 - val_categorical_accuracy: 0.4251
Epoch 26/40
 - 134s - loss: 0.6836 - categorical_accuracy: 0.5401 - val_loss: 0.7977 - val_categorical_accuracy: 0.3858
Epoch 27/40
 - 133s - loss: 0.6851 - categorical_accuracy: 0.5396 - val_loss: 0.7985 - val_categorical_accuracy: 0.4134
Epoch 28/40
 - 134s - loss: 0.6835 - categorical_accuracy: 0.5376 - val_loss: 0.8274 - val_categorical_accuracy: 0.4444
Epoch 29/40
 - 133s - loss: 0.6832 - categorical_accuracy: 0.5380 - val_loss: 0.8558 - val_categorical_accuracy: 0.4410
Epoch 30/40
 - 134s - loss: 0.6821 - categorical_accuracy: 0.5402 - val_loss: 0.8758 - val_categorical_accuracy: 0.4410
Epoch 31/40
 - 133s - loss: 0.6819 - categorical_accuracy: 0.5387 - val_loss: 0.8136 - val_categorical_accuracy: 0.4347
Epoch 32/40
 - 134s - loss: 0.6840 - categorical_accuracy: 0.5377 - val_loss: 0.8141 - val_categorical_accuracy: 0.4318
Epoch 33/40
 - 133s - loss: 0.6841 - categorical_accuracy: 0.5334 - val_loss: 0.8107 - val_categorical_accuracy: 0.4134
Epoch 34/40
 - 133s - loss: 0.6821 - categorical_accuracy: 0.5409 - val_loss: 0.8160 - val_categorical_accuracy: 0.4247
Epoch 35/40
 - 134s - loss: 0.6828 - categorical_accuracy: 0.5376 - val_loss: 0.8401 - val_categorical_accuracy: 0.4159
Epoch 36/40
 - 133s - loss: 0.6834 - categorical_accuracy: 0.5388 - val_loss: 0.8553 - val_categorical_accuracy: 0.4234
Epoch 37/40
 - 133s - loss: 0.6805 - categorical_accuracy: 0.5441 - val_loss: 0.8311 - val_categorical_accuracy: 0.3895
Epoch 38/40
 - 133s - loss: 0.6835 - categorical_accuracy: 0.5428 - val_loss: 0.8741 - val_categorical_accuracy: 0.4331
Epoch 39/40
 - 135s - loss: 0.6837 - categorical_accuracy: 0.5347 - val_loss: 0.8720 - val_categorical_accuracy: 0.4335
Epoch 40/40
 - 140s - loss: 0.6818 - categorical_accuracy: 0.5433 - val_loss: 0.8243 - val_categorical_accuracy: 0.3849

Using TensorFlow backend.

 Test accuracy: 0.4024604569494859
