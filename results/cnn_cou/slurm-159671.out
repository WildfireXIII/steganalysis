  0%|          | 0/10001 [00:00<?, ?it/s]  3%|▎         | 315/10001 [00:00<00:03, 3145.70it/s]  6%|▋         | 637/10001 [00:00<00:02, 3164.67it/s] 10%|▉         | 958/10001 [00:00<00:02, 3175.57it/s] 13%|█▎        | 1289/10001 [00:00<00:02, 3214.65it/s] 16%|█▋        | 1631/10001 [00:00<00:02, 3273.32it/s] 20%|█▉        | 1962/10001 [00:00<00:02, 3282.80it/s] 23%|██▎       | 2320/10001 [00:00<00:02, 3365.42it/s] 26%|██▋       | 2648/10001 [00:00<00:02, 3337.13it/s] 30%|██▉       | 2983/10001 [00:00<00:02, 3340.04it/s] 33%|███▎      | 3305/10001 [00:01<00:02, 3258.20it/s] 36%|███▌      | 3623/10001 [00:01<00:01, 3213.83it/s] 39%|███▉      | 3939/10001 [00:01<00:01, 3192.03it/s] 43%|████▎     | 4255/10001 [00:01<00:01, 3150.53it/s] 46%|████▌     | 4582/10001 [00:01<00:01, 3184.67it/s] 49%|████▉     | 4904/10001 [00:01<00:01, 3193.40it/s] 52%|█████▏    | 5241/10001 [00:01<00:01, 3242.41it/s] 56%|█████▌    | 5565/10001 [00:01<00:01, 3234.72it/s] 59%|█████▉    | 5906/10001 [00:01<00:01, 3283.44it/s] 62%|██████▏   | 6235/10001 [00:01<00:01, 3239.33it/s] 66%|██████▌   | 6559/10001 [00:02<00:01, 3187.97it/s] 69%|██████▉   | 6896/10001 [00:02<00:00, 3238.51it/s] 72%|███████▏  | 7221/10001 [00:02<00:00, 3195.04it/s] 75%|███████▌  | 7541/10001 [00:02<00:00, 3161.24it/s] 79%|███████▊  | 7863/10001 [00:02<00:00, 3177.82it/s] 82%|████████▏ | 8182/10001 [00:02<00:00, 3166.73it/s] 85%|████████▌ | 8511/10001 [00:02<00:00, 3200.49it/s] 88%|████████▊ | 8832/10001 [00:02<00:00, 3154.36it/s] 92%|█████████▏| 9153/10001 [00:02<00:00, 3168.91it/s] 95%|█████████▍| 9471/10001 [00:02<00:00, 3110.61it/s] 98%|█████████▊| 9783/10001 [00:03<00:00, 3106.08it/s]100%|██████████| 10001/10001 [00:03<00:00, 3211.51it/s]
  0%|          | 0/10001 [00:00<?, ?it/s]  3%|▎         | 349/10001 [00:00<00:02, 3484.54it/s]  7%|▋         | 661/10001 [00:00<00:02, 3365.63it/s] 10%|▉         | 997/10001 [00:00<00:02, 3360.98it/s] 13%|█▎        | 1327/10001 [00:00<00:02, 3340.31it/s] 16%|█▋        | 1646/10001 [00:00<00:02, 3293.45it/s] 20%|█▉        | 1968/10001 [00:00<00:02, 3269.64it/s] 23%|██▎       | 2280/10001 [00:00<00:02, 3220.29it/s] 26%|██▌       | 2599/10001 [00:00<00:02, 3207.98it/s] 29%|██▉       | 2915/10001 [00:00<00:02, 3191.37it/s] 32%|███▏      | 3237/10001 [00:01<00:02, 3198.76it/s] 36%|███▌      | 3552/10001 [00:01<00:02, 3183.76it/s] 39%|███▉      | 3885/10001 [00:01<00:01, 3223.60it/s] 42%|████▏     | 4213/10001 [00:01<00:01, 3240.20it/s] 46%|████▌     | 4551/10001 [00:01<00:01, 3279.17it/s] 49%|████▉     | 4901/10001 [00:01<00:01, 3341.37it/s] 52%|█████▏    | 5247/10001 [00:01<00:01, 3374.30it/s] 56%|█████▌    | 5584/10001 [00:01<00:01, 3324.73it/s] 59%|█████▉    | 5918/10001 [00:01<00:01, 3327.52it/s] 63%|██████▎   | 6251/10001 [00:01<00:01, 3283.70it/s] 66%|██████▌   | 6594/10001 [00:02<00:01, 3324.63it/s] 69%|██████▉   | 6927/10001 [00:02<00:00, 3229.30it/s] 73%|███████▎  | 7252/10001 [00:02<00:00, 3234.98it/s] 76%|███████▌  | 7592/10001 [00:02<00:00, 3280.24it/s] 79%|███████▉  | 7921/10001 [00:02<00:00, 3276.20it/s] 83%|████████▎ | 8254/10001 [00:02<00:00, 3289.86it/s] 86%|████████▌ | 8584/10001 [00:02<00:00, 3223.84it/s] 89%|████████▉ | 8907/10001 [00:02<00:00, 3211.00it/s] 92%|█████████▏| 9232/10001 [00:02<00:00, 3221.87it/s] 96%|█████████▌| 9569/10001 [00:02<00:00, 3264.62it/s] 99%|█████████▉| 9904/10001 [00:03<00:00, 3287.09it/s]100%|██████████| 10001/10001 [00:03<00:00, 3264.36it/s]2019-02-23 20:22:58.570436: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-02-23 20:22:58.748687: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2019-02-23 20:22:58.748729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-02-23 20:22:59.072422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-02-23 20:22:59.072467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-02-23 20:22:59.072474: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-02-23 20:22:59.072732: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10758 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
41
[151, 439, 964, 1154, 1353, 1570, 1655, 2164, 2271, 2490, 2665, 3476, 3625, 3642, 3842, 4855, 4968, 4989, 5060, 5133, 5352, 5757, 5871, 5931, 6215, 6240, 6659, 6848, 6855, 6881, 6926, 7175, 7180, 7337, 7362, 7933, 7991, 8066, 8943, 9426, 10001]
45
[151, 439, 724, 964, 1154, 1353, 1570, 1655, 2164, 2271, 2490, 2665, 3476, 3625, 3642, 3842, 4855, 4968, 4989, 5060, 5133, 5352, 5757, 5871, 5931, 6031, 6215, 6240, 6659, 6848, 6855, 6881, 6926, 7175, 7180, 7337, 7362, 7933, 7991, 8066, 8884, 8943, 9426, 9603, 10001]
9960
9955
(15932, 512, 512, 1)
(3983, 512, 512, 1)
(15932, 2)
(3983, 2)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 510, 510, 1)       10        
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 2, 2, 64)          16581248  
_________________________________________________________________
flatten (Flatten)            (None, 256)               0         
_________________________________________________________________
dense (Dense)                (None, 2)                 514       
_________________________________________________________________
softmax (Softmax)            (None, 2)                 0         
=================================================================
Total params: 16,581,772
Trainable params: 16,581,772
Non-trainable params: 0
_________________________________________________________________
Train on 13542 samples, validate on 2390 samples
Epoch 1/40
 - 294s - loss: 0.7331 - categorical_accuracy: 0.5571 - val_loss: 0.7530 - val_categorical_accuracy: 0.5004
Epoch 2/40
 - 135s - loss: 0.4472 - categorical_accuracy: 0.8970 - val_loss: 0.3642 - val_categorical_accuracy: 0.8908
Epoch 3/40
 - 134s - loss: 0.2356 - categorical_accuracy: 0.9484 - val_loss: 0.2060 - val_categorical_accuracy: 0.9519
Epoch 4/40
 - 135s - loss: 0.1309 - categorical_accuracy: 0.9655 - val_loss: 0.3810 - val_categorical_accuracy: 0.8464
Epoch 5/40
 - 134s - loss: 0.0886 - categorical_accuracy: 0.9728 - val_loss: 0.1484 - val_categorical_accuracy: 0.9636
Epoch 6/40
 - 135s - loss: 0.0560 - categorical_accuracy: 0.9801 - val_loss: 0.0974 - val_categorical_accuracy: 0.9686
Epoch 7/40
 - 134s - loss: 0.0403 - categorical_accuracy: 0.9846 - val_loss: 0.0932 - val_categorical_accuracy: 0.9695
Epoch 8/40
 - 135s - loss: 0.0271 - categorical_accuracy: 0.9897 - val_loss: 0.0836 - val_categorical_accuracy: 0.9711
Epoch 9/40
 - 134s - loss: 0.0209 - categorical_accuracy: 0.9924 - val_loss: 0.0821 - val_categorical_accuracy: 0.9711
Epoch 10/40
 - 135s - loss: 0.0157 - categorical_accuracy: 0.9945 - val_loss: 0.0828 - val_categorical_accuracy: 0.9724
Epoch 11/40
 - 134s - loss: 0.0135 - categorical_accuracy: 0.9944 - val_loss: 0.0777 - val_categorical_accuracy: 0.9711
Epoch 12/40
 - 135s - loss: 0.0118 - categorical_accuracy: 0.9957 - val_loss: 0.0766 - val_categorical_accuracy: 0.9724
Epoch 13/40
 - 135s - loss: 0.0092 - categorical_accuracy: 0.9969 - val_loss: 0.0780 - val_categorical_accuracy: 0.9703
Epoch 14/40
 - 135s - loss: 0.0087 - categorical_accuracy: 0.9972 - val_loss: 0.0774 - val_categorical_accuracy: 0.9715
Epoch 15/40
 - 134s - loss: 0.0072 - categorical_accuracy: 0.9974 - val_loss: 0.0748 - val_categorical_accuracy: 0.9720
Epoch 16/40
 - 135s - loss: 0.0065 - categorical_accuracy: 0.9980 - val_loss: 0.0769 - val_categorical_accuracy: 0.9711
Epoch 17/40
 - 134s - loss: 0.0063 - categorical_accuracy: 0.9981 - val_loss: 0.0743 - val_categorical_accuracy: 0.9711
Epoch 18/40
 - 135s - loss: 0.0056 - categorical_accuracy: 0.9985 - val_loss: 0.0762 - val_categorical_accuracy: 0.9715
Epoch 19/40
 - 134s - loss: 0.0101 - categorical_accuracy: 0.9976 - val_loss: 0.0709 - val_categorical_accuracy: 0.9741
Epoch 20/40
 - 136s - loss: 0.0071 - categorical_accuracy: 0.9981 - val_loss: 0.0788 - val_categorical_accuracy: 0.9732
Epoch 21/40
 - 134s - loss: 0.0058 - categorical_accuracy: 0.9982 - val_loss: 0.0710 - val_categorical_accuracy: 0.9732
Epoch 22/40
 - 135s - loss: 0.0055 - categorical_accuracy: 0.9986 - val_loss: 0.0734 - val_categorical_accuracy: 0.9720
Epoch 23/40
 - 134s - loss: 0.0059 - categorical_accuracy: 0.9982 - val_loss: 0.0726 - val_categorical_accuracy: 0.9724
Epoch 24/40
 - 135s - loss: 0.0049 - categorical_accuracy: 0.9985 - val_loss: 0.0715 - val_categorical_accuracy: 0.9736
Epoch 25/40
 - 134s - loss: 0.0048 - categorical_accuracy: 0.9984 - val_loss: 0.0727 - val_categorical_accuracy: 0.9732
Epoch 26/40
 - 135s - loss: 0.0041 - categorical_accuracy: 0.9990 - val_loss: 0.0719 - val_categorical_accuracy: 0.9732
Epoch 27/40
 - 134s - loss: 0.0041 - categorical_accuracy: 0.9990 - val_loss: 0.0735 - val_categorical_accuracy: 0.9728
Epoch 28/40
 - 135s - loss: 0.0040 - categorical_accuracy: 0.9988 - val_loss: 0.0719 - val_categorical_accuracy: 0.9732
Epoch 29/40
 - 134s - loss: 0.0043 - categorical_accuracy: 0.9984 - val_loss: 0.0703 - val_categorical_accuracy: 0.9728
Epoch 30/40
 - 136s - loss: 0.0045 - categorical_accuracy: 0.9984 - val_loss: 0.0721 - val_categorical_accuracy: 0.9728
Epoch 31/40
 - 134s - loss: 0.0038 - categorical_accuracy: 0.9987 - val_loss: 0.0741 - val_categorical_accuracy: 0.9732
Epoch 32/40
 - 135s - loss: 0.0037 - categorical_accuracy: 0.9990 - val_loss: 0.0726 - val_categorical_accuracy: 0.9732
Epoch 33/40
 - 134s - loss: 0.0037 - categorical_accuracy: 0.9991 - val_loss: 0.0721 - val_categorical_accuracy: 0.9736
Epoch 34/40
 - 136s - loss: 0.0035 - categorical_accuracy: 0.9992 - val_loss: 0.0709 - val_categorical_accuracy: 0.9749
Epoch 35/40
 - 134s - loss: 0.0041 - categorical_accuracy: 0.9986 - val_loss: 0.0733 - val_categorical_accuracy: 0.9736
Epoch 36/40
 - 135s - loss: 0.0039 - categorical_accuracy: 0.9983 - val_loss: 0.0718 - val_categorical_accuracy: 0.9745
Epoch 37/40
 - 134s - loss: 0.0041 - categorical_accuracy: 0.9983 - val_loss: 0.0712 - val_categorical_accuracy: 0.9745
Epoch 38/40
 - 136s - loss: 0.0037 - categorical_accuracy: 0.9989 - val_loss: 0.0721 - val_categorical_accuracy: 0.9749
Epoch 39/40
 - 133s - loss: 0.0032 - categorical_accuracy: 0.9994 - val_loss: 0.0718 - val_categorical_accuracy: 0.9741
Epoch 40/40
 - 133s - loss: 0.0032 - categorical_accuracy: 0.9993 - val_loss: 0.0720 - val_categorical_accuracy: 0.9745

Using TensorFlow backend.

 Test accuracy: 0.9846849108712026
