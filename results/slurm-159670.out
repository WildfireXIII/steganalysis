  0%|          | 0/10001 [00:00<?, ?it/s]  3%|▎         | 347/10001 [00:00<00:02, 3462.73it/s]  7%|▋         | 713/10001 [00:00<00:02, 3517.22it/s] 11%|█         | 1059/10001 [00:00<00:02, 3497.74it/s] 14%|█▍        | 1407/10001 [00:00<00:02, 3491.09it/s] 17%|█▋        | 1749/10001 [00:00<00:02, 3466.62it/s] 21%|██        | 2097/10001 [00:00<00:02, 3468.09it/s] 24%|██▍       | 2446/10001 [00:00<00:02, 3472.01it/s] 28%|██▊       | 2789/10001 [00:00<00:02, 3456.80it/s] 31%|███▏      | 3143/10001 [00:00<00:01, 3480.80it/s] 35%|███▍      | 3483/10001 [00:01<00:01, 3455.62it/s] 38%|███▊      | 3834/10001 [00:01<00:01, 3469.07it/s] 42%|████▏     | 4200/10001 [00:01<00:01, 3522.82it/s] 46%|████▌     | 4570/10001 [00:01<00:01, 3572.36it/s] 49%|████▉     | 4941/10001 [00:01<00:01, 3609.85it/s] 53%|█████▎    | 5300/10001 [00:01<00:01, 3582.00it/s] 57%|█████▋    | 5657/10001 [00:01<00:01, 3549.38it/s] 60%|██████    | 6013/10001 [00:01<00:01, 3550.30it/s] 64%|██████▎   | 6368/10001 [00:01<00:01, 3533.30it/s] 67%|██████▋   | 6745/10001 [00:01<00:00, 3600.19it/s] 71%|███████▏  | 7126/10001 [00:02<00:00, 3660.53it/s] 75%|███████▍  | 7493/10001 [00:02<00:00, 3652.43it/s] 79%|███████▊  | 7864/10001 [00:02<00:00, 3667.78it/s] 82%|████████▏ | 8231/10001 [00:02<00:00, 3619.66it/s] 86%|████████▌ | 8594/10001 [00:02<00:00, 3567.12it/s] 90%|████████▉ | 8952/10001 [00:02<00:00, 3554.44it/s] 93%|█████████▎| 9309/10001 [00:02<00:00, 3556.43it/s] 97%|█████████▋| 9665/10001 [00:02<00:00, 3515.39it/s]100%|██████████| 10001/10001 [00:02<00:00, 3549.99it/s]
  0%|          | 0/10001 [00:00<?, ?it/s]  4%|▎         | 363/10001 [00:00<00:02, 3629.24it/s]  7%|▋         | 733/10001 [00:00<00:02, 3649.11it/s] 11%|█         | 1089/10001 [00:00<00:02, 3619.68it/s] 15%|█▍        | 1467/10001 [00:00<00:02, 3665.90it/s] 18%|█▊        | 1828/10001 [00:00<00:02, 3646.32it/s] 22%|██▏       | 2188/10001 [00:00<00:02, 3630.65it/s] 25%|██▌       | 2550/10001 [00:00<00:02, 3625.93it/s] 29%|██▉       | 2936/10001 [00:00<00:01, 3691.20it/s] 33%|███▎      | 3319/10001 [00:00<00:01, 3729.33it/s] 37%|███▋      | 3705/10001 [00:01<00:01, 3766.42it/s] 41%|████      | 4089/10001 [00:01<00:01, 3786.78it/s] 45%|████▍     | 4461/10001 [00:01<00:01, 3756.87it/s] 48%|████▊     | 4832/10001 [00:01<00:01, 3717.99it/s] 52%|█████▏    | 5213/10001 [00:01<00:01, 3744.61it/s] 56%|█████▌    | 5586/10001 [00:01<00:01, 3679.46it/s] 60%|█████▉    | 5962/10001 [00:01<00:01, 3701.85it/s] 63%|██████▎   | 6334/10001 [00:01<00:00, 3706.12it/s] 67%|██████▋   | 6736/10001 [00:01<00:00, 3792.46it/s] 71%|███████▏  | 7139/10001 [00:01<00:00, 3858.25it/s] 75%|███████▌  | 7526/10001 [00:02<00:00, 3850.25it/s] 79%|███████▉  | 7912/10001 [00:02<00:00, 3788.75it/s] 83%|████████▎ | 8292/10001 [00:02<00:00, 3745.53it/s] 87%|████████▋ | 8667/10001 [00:02<00:00, 3683.31it/s] 90%|█████████ | 9036/10001 [00:02<00:00, 3665.21it/s] 94%|█████████▍| 9403/10001 [00:02<00:00, 3620.52it/s] 98%|█████████▊| 9766/10001 [00:02<00:00, 3585.60it/s]100%|██████████| 10001/10001 [00:02<00:00, 3701.79it/s]2019-02-23 20:19:45.851046: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-02-23 20:19:46.028618: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:06:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2019-02-23 20:19:46.028664: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-02-23 20:19:46.349128: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-02-23 20:19:46.349173: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-02-23 20:19:46.349179: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-02-23 20:19:46.349438: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10758 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:06:00.0, compute capability: 3.7)
41
[151, 439, 964, 1154, 1353, 1570, 1655, 2164, 2271, 2490, 2665, 3476, 3625, 3642, 3842, 4855, 4968, 4989, 5060, 5133, 5352, 5757, 5871, 5931, 6215, 6240, 6659, 6848, 6855, 6881, 6926, 7175, 7180, 7337, 7362, 7933, 7991, 8066, 8943, 9426, 10001]
45
[151, 439, 724, 964, 1154, 1353, 1570, 1655, 2164, 2271, 2490, 2665, 3476, 3625, 3642, 3842, 4855, 4968, 4989, 5060, 5133, 5352, 5757, 5871, 5931, 6031, 6215, 6240, 6659, 6848, 6855, 6881, 6926, 7175, 7180, 7337, 7362, 7933, 7991, 8066, 8884, 8943, 9426, 9603, 10001]
9960
9955
(15932, 512, 512, 1)
(3983, 512, 512, 1)
(15932, 2)
(3983, 2)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 510, 510, 1)       10        
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 2, 2, 64)          16581248  
_________________________________________________________________
flatten (Flatten)            (None, 256)               0         
_________________________________________________________________
dense (Dense)                (None, 2)                 514       
_________________________________________________________________
softmax (Softmax)            (None, 2)                 0         
=================================================================
Total params: 16,581,772
Trainable params: 16,581,772
Non-trainable params: 0
_________________________________________________________________
Train on 13542 samples, validate on 2390 samples
Epoch 1/40
 - 288s - loss: 0.7520 - categorical_accuracy: 0.4779 - val_loss: 0.7868 - val_categorical_accuracy: 0.5021
Epoch 2/40
 - 130s - loss: 0.7037 - categorical_accuracy: 0.4948 - val_loss: 0.7438 - val_categorical_accuracy: 0.4782
Epoch 3/40
 - 129s - loss: 0.7005 - categorical_accuracy: 0.5030 - val_loss: 0.7322 - val_categorical_accuracy: 0.4046
Epoch 4/40
 - 130s - loss: 0.6929 - categorical_accuracy: 0.5315 - val_loss: 0.7567 - val_categorical_accuracy: 0.4331
Epoch 5/40
 - 129s - loss: 0.6893 - categorical_accuracy: 0.5366 - val_loss: 0.7742 - val_categorical_accuracy: 0.4360
Epoch 6/40
 - 130s - loss: 0.6708 - categorical_accuracy: 0.6219 - val_loss: 0.8189 - val_categorical_accuracy: 0.4774
Epoch 7/40
 - 129s - loss: 0.5855 - categorical_accuracy: 0.7581 - val_loss: 0.7590 - val_categorical_accuracy: 0.5728
Epoch 8/40
 - 130s - loss: 0.4322 - categorical_accuracy: 0.8582 - val_loss: 0.7223 - val_categorical_accuracy: 0.6741
Epoch 9/40
 - 129s - loss: 0.3224 - categorical_accuracy: 0.8855 - val_loss: 0.5638 - val_categorical_accuracy: 0.7598
Epoch 10/40
 - 130s - loss: 0.2117 - categorical_accuracy: 0.9123 - val_loss: 0.5012 - val_categorical_accuracy: 0.7979
Epoch 11/40
 - 129s - loss: 0.1599 - categorical_accuracy: 0.9225 - val_loss: 0.4344 - val_categorical_accuracy: 0.8289
Epoch 12/40
 - 130s - loss: 0.1297 - categorical_accuracy: 0.9319 - val_loss: 0.4040 - val_categorical_accuracy: 0.8368
Epoch 13/40
 - 129s - loss: 0.1078 - categorical_accuracy: 0.9418 - val_loss: 0.3788 - val_categorical_accuracy: 0.8565
Epoch 14/40
 - 131s - loss: 0.0917 - categorical_accuracy: 0.9510 - val_loss: 0.3496 - val_categorical_accuracy: 0.8720
Epoch 15/40
 - 129s - loss: 0.0859 - categorical_accuracy: 0.9533 - val_loss: 0.3504 - val_categorical_accuracy: 0.8690
Epoch 16/40
 - 130s - loss: 0.0727 - categorical_accuracy: 0.9606 - val_loss: 0.3193 - val_categorical_accuracy: 0.8766
Epoch 17/40
 - 129s - loss: 0.0651 - categorical_accuracy: 0.9646 - val_loss: 0.3400 - val_categorical_accuracy: 0.8787
Epoch 18/40
 - 130s - loss: 0.0604 - categorical_accuracy: 0.9673 - val_loss: 0.3038 - val_categorical_accuracy: 0.8862
Epoch 19/40
 - 129s - loss: 0.0561 - categorical_accuracy: 0.9703 - val_loss: 0.2877 - val_categorical_accuracy: 0.8958
Epoch 20/40
 - 130s - loss: 0.0517 - categorical_accuracy: 0.9711 - val_loss: 0.2702 - val_categorical_accuracy: 0.9121
Epoch 21/40
 - 129s - loss: 0.0512 - categorical_accuracy: 0.9743 - val_loss: 0.2681 - val_categorical_accuracy: 0.9084
Epoch 22/40
 - 130s - loss: 0.0470 - categorical_accuracy: 0.9766 - val_loss: 0.2659 - val_categorical_accuracy: 0.9113
Epoch 23/40
 - 129s - loss: 0.0454 - categorical_accuracy: 0.9756 - val_loss: 0.2588 - val_categorical_accuracy: 0.9042
Epoch 24/40
 - 130s - loss: 0.0426 - categorical_accuracy: 0.9779 - val_loss: 0.2408 - val_categorical_accuracy: 0.9197
Epoch 25/40
 - 129s - loss: 0.0428 - categorical_accuracy: 0.9778 - val_loss: 0.2420 - val_categorical_accuracy: 0.9197
Epoch 26/40
 - 130s - loss: 0.0407 - categorical_accuracy: 0.9781 - val_loss: 0.2411 - val_categorical_accuracy: 0.9176
Epoch 27/40
 - 129s - loss: 0.0398 - categorical_accuracy: 0.9791 - val_loss: 0.2296 - val_categorical_accuracy: 0.9230
Epoch 28/40
 - 130s - loss: 0.0389 - categorical_accuracy: 0.9799 - val_loss: 0.2587 - val_categorical_accuracy: 0.9134
Epoch 29/40
 - 129s - loss: 0.0410 - categorical_accuracy: 0.9772 - val_loss: 0.2211 - val_categorical_accuracy: 0.9272
Epoch 30/40
 - 130s - loss: 0.0388 - categorical_accuracy: 0.9800 - val_loss: 0.2233 - val_categorical_accuracy: 0.9289
Epoch 31/40
 - 129s - loss: 0.0351 - categorical_accuracy: 0.9802 - val_loss: 0.2187 - val_categorical_accuracy: 0.9293
Epoch 32/40
 - 130s - loss: 0.0350 - categorical_accuracy: 0.9812 - val_loss: 0.2176 - val_categorical_accuracy: 0.9293
Epoch 33/40
 - 129s - loss: 0.0325 - categorical_accuracy: 0.9820 - val_loss: 0.2078 - val_categorical_accuracy: 0.9293
Epoch 34/40
 - 130s - loss: 0.0313 - categorical_accuracy: 0.9827 - val_loss: 0.2043 - val_categorical_accuracy: 0.9335
Epoch 35/40
 - 129s - loss: 0.0319 - categorical_accuracy: 0.9829 - val_loss: 0.2322 - val_categorical_accuracy: 0.9218
Epoch 36/40
 - 130s - loss: 0.0335 - categorical_accuracy: 0.9818 - val_loss: 0.2079 - val_categorical_accuracy: 0.9305
Epoch 37/40
 - 129s - loss: 0.0318 - categorical_accuracy: 0.9837 - val_loss: 0.1815 - val_categorical_accuracy: 0.9389
Epoch 38/40
 - 130s - loss: 0.0310 - categorical_accuracy: 0.9854 - val_loss: 0.1881 - val_categorical_accuracy: 0.9397
Epoch 39/40
 - 129s - loss: 0.0320 - categorical_accuracy: 0.9825 - val_loss: 0.2078 - val_categorical_accuracy: 0.9360
Epoch 40/40
 - 131s - loss: 0.0316 - categorical_accuracy: 0.9835 - val_loss: 0.1900 - val_categorical_accuracy: 0.9372

Using TensorFlow backend.

 Test accuracy: 0.9364800401707256
