  0%|          | 0/10001 [00:00<?, ?it/s]  3%|▎         | 294/10001 [00:00<00:03, 2933.89it/s]  6%|▋         | 627/10001 [00:00<00:03, 3040.38it/s]  9%|▉         | 948/10001 [00:00<00:02, 3087.96it/s] 13%|█▎        | 1305/10001 [00:00<00:02, 3216.86it/s] 17%|█▋        | 1667/10001 [00:00<00:02, 3326.22it/s] 20%|██        | 2029/10001 [00:00<00:02, 3407.67it/s] 24%|██▍       | 2394/10001 [00:00<00:02, 3474.30it/s] 28%|██▊       | 2758/10001 [00:00<00:02, 3520.02it/s] 31%|███       | 3121/10001 [00:00<00:01, 3550.52it/s] 35%|███▍      | 3467/10001 [00:01<00:01, 3521.77it/s] 39%|███▊      | 3851/10001 [00:01<00:01, 3609.66it/s] 42%|████▏     | 4225/10001 [00:01<00:01, 3647.29it/s] 46%|████▌     | 4593/10001 [00:01<00:01, 3654.61it/s] 50%|████▉     | 4966/10001 [00:01<00:01, 3676.65it/s] 53%|█████▎    | 5333/10001 [00:01<00:01, 3657.29it/s] 57%|█████▋    | 5698/10001 [00:01<00:01, 3586.73it/s] 61%|██████    | 6060/10001 [00:01<00:01, 3595.61it/s] 64%|██████▍   | 6433/10001 [00:01<00:00, 3633.29it/s] 68%|██████▊   | 6797/10001 [00:01<00:00, 3602.13it/s] 72%|███████▏  | 7158/10001 [00:02<00:00, 3600.67it/s] 75%|███████▌  | 7519/10001 [00:02<00:00, 3574.65it/s] 79%|███████▉  | 7877/10001 [00:02<00:00, 3562.61it/s] 82%|████████▏ | 8234/10001 [00:02<00:00, 3555.75it/s] 86%|████████▌ | 8597/10001 [00:02<00:00, 3575.20it/s] 90%|████████▉ | 8955/10001 [00:02<00:00, 3562.11it/s] 93%|█████████▎| 9319/10001 [00:02<00:00, 3582.33it/s] 97%|█████████▋| 9678/10001 [00:02<00:00, 3538.59it/s]100%|██████████| 10001/10001 [00:02<00:00, 3552.81it/s]
  0%|          | 0/10001 [00:00<?, ?it/s]  3%|▎         | 343/10001 [00:00<00:02, 3425.66it/s]  7%|▋         | 706/10001 [00:00<00:02, 3482.15it/s] 11%|█         | 1052/10001 [00:00<00:02, 3475.20it/s] 14%|█▍        | 1413/10001 [00:00<00:02, 3512.07it/s] 18%|█▊        | 1764/10001 [00:00<00:02, 3508.68it/s] 21%|██        | 2116/10001 [00:00<00:02, 3511.61it/s] 25%|██▍       | 2474/10001 [00:00<00:02, 3530.66it/s] 28%|██▊       | 2831/10001 [00:00<00:02, 3540.97it/s] 32%|███▏      | 3186/10001 [00:00<00:01, 3540.92it/s] 35%|███▌      | 3533/10001 [00:01<00:01, 3517.41it/s] 39%|███▉      | 3888/10001 [00:01<00:01, 3524.95it/s] 43%|████▎     | 4251/10001 [00:01<00:01, 3553.25it/s] 46%|████▋     | 4629/10001 [00:01<00:01, 3616.37it/s] 50%|█████     | 5009/10001 [00:01<00:01, 3669.09it/s] 54%|█████▎    | 5375/10001 [00:01<00:01, 3646.28it/s] 57%|█████▋    | 5739/10001 [00:01<00:01, 3601.13it/s] 61%|██████    | 6099/10001 [00:01<00:01, 3587.85it/s] 65%|██████▍   | 6458/10001 [00:01<00:00, 3586.46it/s] 68%|██████▊   | 6817/10001 [00:01<00:00, 3570.52it/s] 72%|███████▏  | 7175/10001 [00:02<00:00, 3572.35it/s] 75%|███████▌  | 7533/10001 [00:02<00:00, 3519.71it/s] 79%|███████▉  | 7904/10001 [00:02<00:00, 3561.54it/s] 83%|████████▎ | 8272/10001 [00:02<00:00, 3595.07it/s] 86%|████████▋ | 8639/10001 [00:02<00:00, 3615.87it/s] 90%|█████████ | 9005/10001 [00:02<00:00, 3628.05it/s] 94%|█████████▍| 9378/10001 [00:02<00:00, 3656.34it/s] 97%|█████████▋| 9746/10001 [00:02<00:00, 3662.71it/s]100%|██████████| 10001/10001 [00:02<00:00, 3587.38it/s]2019-02-24 02:39:48.300034: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-02-24 02:39:48.477887: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2019-02-24 02:39:48.477933: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-02-24 02:39:48.798753: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-02-24 02:39:48.798799: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-02-24 02:39:48.798806: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-02-24 02:39:48.799058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10758 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
41
[151, 439, 964, 1154, 1353, 1570, 1655, 2164, 2271, 2490, 2665, 3476, 3625, 3642, 3842, 4855, 4968, 4989, 5060, 5133, 5352, 5757, 5871, 5931, 6215, 6240, 6659, 6848, 6855, 6881, 6926, 7175, 7180, 7337, 7362, 7933, 7991, 8066, 8943, 9426, 10001]
42
[151, 439, 840, 964, 1154, 1353, 1570, 1655, 2164, 2271, 2490, 2665, 3476, 3625, 3642, 3842, 4855, 4968, 4989, 5060, 5133, 5352, 5757, 5871, 5931, 6240, 6659, 6848, 6855, 6881, 6926, 7175, 7180, 7337, 7362, 7933, 7991, 8066, 8943, 9426, 9603, 10001]
9960
9958
(15934, 512, 512, 1)
(3984, 512, 512, 1)
(15934, 2)
(3984, 2)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 510, 510, 1)       10        
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 2, 2, 64)          16581248  
_________________________________________________________________
flatten (Flatten)            (None, 256)               0         
_________________________________________________________________
dense (Dense)                (None, 2)                 514       
_________________________________________________________________
softmax (Softmax)            (None, 2)                 0         
=================================================================
Total params: 16,581,772
Trainable params: 16,581,772
Non-trainable params: 0
_________________________________________________________________
Train on 13543 samples, validate on 2391 samples
Epoch 1/40
 - 296s - loss: 0.7489 - categorical_accuracy: 0.4939 - val_loss: 0.7086 - val_categorical_accuracy: 0.4948
Epoch 2/40
 - 134s - loss: 0.6949 - categorical_accuracy: 0.5237 - val_loss: 0.7034 - val_categorical_accuracy: 0.4500
Epoch 3/40
 - 136s - loss: 0.6336 - categorical_accuracy: 0.7145 - val_loss: 0.6848 - val_categorical_accuracy: 0.6675
Epoch 4/40
 - 134s - loss: 0.4087 - categorical_accuracy: 0.8807 - val_loss: 0.4960 - val_categorical_accuracy: 0.7771
Epoch 5/40
 - 136s - loss: 0.2690 - categorical_accuracy: 0.9178 - val_loss: 0.3257 - val_categorical_accuracy: 0.8695
Epoch 6/40
 - 134s - loss: 0.1555 - categorical_accuracy: 0.9424 - val_loss: 0.2463 - val_categorical_accuracy: 0.9030
Epoch 7/40
 - 136s - loss: 0.1002 - categorical_accuracy: 0.9562 - val_loss: 0.2025 - val_categorical_accuracy: 0.9197
Epoch 8/40
 - 134s - loss: 0.0697 - categorical_accuracy: 0.9690 - val_loss: 0.1787 - val_categorical_accuracy: 0.9276
Epoch 9/40
 - 136s - loss: 0.0513 - categorical_accuracy: 0.9760 - val_loss: 0.2599 - val_categorical_accuracy: 0.8996
Epoch 10/40
 - 134s - loss: 0.0424 - categorical_accuracy: 0.9820 - val_loss: 0.1456 - val_categorical_accuracy: 0.9414
Epoch 11/40
 - 136s - loss: 0.0351 - categorical_accuracy: 0.9851 - val_loss: 0.1395 - val_categorical_accuracy: 0.9419
Epoch 12/40
 - 134s - loss: 0.0304 - categorical_accuracy: 0.9863 - val_loss: 0.1290 - val_categorical_accuracy: 0.9481
Epoch 13/40
 - 136s - loss: 0.0295 - categorical_accuracy: 0.9879 - val_loss: 0.1254 - val_categorical_accuracy: 0.9498
Epoch 14/40
 - 134s - loss: 0.0241 - categorical_accuracy: 0.9899 - val_loss: 0.1210 - val_categorical_accuracy: 0.9506
Epoch 15/40
 - 136s - loss: 0.0253 - categorical_accuracy: 0.9886 - val_loss: 0.1116 - val_categorical_accuracy: 0.9544
Epoch 16/40
 - 134s - loss: 0.0216 - categorical_accuracy: 0.9901 - val_loss: 0.1104 - val_categorical_accuracy: 0.9569
Epoch 17/40
 - 136s - loss: 0.0385 - categorical_accuracy: 0.9876 - val_loss: 0.1180 - val_categorical_accuracy: 0.9515
Epoch 18/40
 - 134s - loss: 0.0212 - categorical_accuracy: 0.9909 - val_loss: 0.1135 - val_categorical_accuracy: 0.9544
Epoch 19/40
 - 136s - loss: 0.0202 - categorical_accuracy: 0.9906 - val_loss: 0.1033 - val_categorical_accuracy: 0.9590
Epoch 20/40
 - 134s - loss: 0.0215 - categorical_accuracy: 0.9906 - val_loss: 0.1015 - val_categorical_accuracy: 0.9632
Epoch 21/40
 - 136s - loss: 0.0181 - categorical_accuracy: 0.9922 - val_loss: 0.1027 - val_categorical_accuracy: 0.9619
Epoch 22/40
 - 134s - loss: 0.0208 - categorical_accuracy: 0.9906 - val_loss: 0.1071 - val_categorical_accuracy: 0.9615
Epoch 23/40
 - 136s - loss: 0.0170 - categorical_accuracy: 0.9919 - val_loss: 0.1030 - val_categorical_accuracy: 0.9611
Epoch 24/40
 - 134s - loss: 0.0157 - categorical_accuracy: 0.9927 - val_loss: 0.1018 - val_categorical_accuracy: 0.9628
Epoch 25/40
 - 136s - loss: 0.0154 - categorical_accuracy: 0.9937 - val_loss: 0.1041 - val_categorical_accuracy: 0.9615
Epoch 26/40
 - 134s - loss: 0.0172 - categorical_accuracy: 0.9928 - val_loss: 0.1123 - val_categorical_accuracy: 0.9586
Epoch 27/40
 - 136s - loss: 0.0149 - categorical_accuracy: 0.9943 - val_loss: 0.1014 - val_categorical_accuracy: 0.9632
Epoch 28/40
 - 135s - loss: 0.0139 - categorical_accuracy: 0.9939 - val_loss: 0.0979 - val_categorical_accuracy: 0.9661
Epoch 29/40
 - 136s - loss: 0.0149 - categorical_accuracy: 0.9929 - val_loss: 0.0935 - val_categorical_accuracy: 0.9649
Epoch 30/40
 - 134s - loss: 0.0142 - categorical_accuracy: 0.9934 - val_loss: 0.0933 - val_categorical_accuracy: 0.9665
Epoch 31/40
 - 136s - loss: 0.0151 - categorical_accuracy: 0.9936 - val_loss: 0.0938 - val_categorical_accuracy: 0.9724
Epoch 32/40
 - 134s - loss: 0.0138 - categorical_accuracy: 0.9949 - val_loss: 0.0920 - val_categorical_accuracy: 0.9674
Epoch 33/40
 - 136s - loss: 0.0127 - categorical_accuracy: 0.9948 - val_loss: 0.0930 - val_categorical_accuracy: 0.9665
Epoch 34/40
 - 135s - loss: 0.0119 - categorical_accuracy: 0.9947 - val_loss: 0.0940 - val_categorical_accuracy: 0.9661
Epoch 35/40
 - 135s - loss: 0.0114 - categorical_accuracy: 0.9944 - val_loss: 0.1018 - val_categorical_accuracy: 0.9665
Epoch 36/40
 - 132s - loss: 0.0119 - categorical_accuracy: 0.9945 - val_loss: 0.0851 - val_categorical_accuracy: 0.9703
Epoch 37/40
 - 134s - loss: 0.0116 - categorical_accuracy: 0.9948 - val_loss: 0.0872 - val_categorical_accuracy: 0.9657
Epoch 38/40
 - 133s - loss: 0.0110 - categorical_accuracy: 0.9945 - val_loss: 0.0864 - val_categorical_accuracy: 0.9686
Epoch 39/40
 - 134s - loss: 0.0110 - categorical_accuracy: 0.9952 - val_loss: 0.0884 - val_categorical_accuracy: 0.9678
Epoch 40/40
 - 133s - loss: 0.0108 - categorical_accuracy: 0.9951 - val_loss: 0.0833 - val_categorical_accuracy: 0.9707

Using TensorFlow backend.

 Test accuracy: 0.9741465863453815
