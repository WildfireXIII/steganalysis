  0%|          | 0/10001 [00:00<?, ?it/s]  3%|▎         | 277/10001 [00:00<00:03, 2761.48it/s]  6%|▌         | 608/10001 [00:00<00:03, 2905.64it/s]  9%|▉         | 926/10001 [00:00<00:03, 2980.70it/s] 13%|█▎        | 1276/10001 [00:00<00:02, 3119.04it/s] 16%|█▋        | 1645/10001 [00:00<00:02, 3270.52it/s] 20%|██        | 2013/10001 [00:00<00:02, 3381.07it/s] 24%|██▍       | 2378/10001 [00:00<00:02, 3456.69it/s] 27%|██▋       | 2742/10001 [00:00<00:02, 3507.10it/s] 31%|███       | 3103/10001 [00:00<00:01, 3535.67it/s] 35%|███▍      | 3459/10001 [00:01<00:01, 3540.69it/s] 38%|███▊      | 3820/10001 [00:01<00:01, 3559.15it/s] 42%|████▏     | 4187/10001 [00:01<00:01, 3589.60it/s] 45%|████▌     | 4543/10001 [00:01<00:01, 3539.06it/s] 49%|████▉     | 4906/10001 [00:01<00:01, 3565.60it/s] 53%|█████▎    | 5262/10001 [00:01<00:01, 3491.50it/s] 56%|█████▌    | 5611/10001 [00:01<00:01, 3434.22it/s] 60%|█████▉    | 5971/10001 [00:01<00:01, 3481.07it/s] 63%|██████▎   | 6342/10001 [00:01<00:01, 3545.09it/s] 67%|██████▋   | 6718/10001 [00:01<00:00, 3605.95it/s] 71%|███████   | 7092/10001 [00:02<00:00, 3644.48it/s] 75%|███████▍  | 7457/10001 [00:02<00:00, 3608.99it/s] 78%|███████▊  | 7819/10001 [00:02<00:00, 3593.14it/s] 82%|████████▏ | 8194/10001 [00:02<00:00, 3637.76it/s] 86%|████████▌ | 8559/10001 [00:02<00:00, 3637.21it/s] 89%|████████▉ | 8923/10001 [00:02<00:00, 3577.10it/s] 93%|█████████▎| 9302/10001 [00:02<00:00, 3637.47it/s] 97%|█████████▋| 9667/10001 [00:02<00:00, 3581.53it/s]100%|██████████| 10001/10001 [00:02<00:00, 3536.29it/s]
  0%|          | 0/10001 [00:00<?, ?it/s]  3%|▎         | 320/10001 [00:00<00:03, 3199.62it/s]  7%|▋         | 678/10001 [00:00<00:02, 3304.11it/s] 10%|█         | 1028/10001 [00:00<00:02, 3357.87it/s] 14%|█▍        | 1377/10001 [00:00<00:02, 3394.50it/s] 17%|█▋        | 1733/10001 [00:00<00:02, 3439.80it/s] 21%|██        | 2060/10001 [00:00<00:02, 3384.50it/s] 24%|██▍       | 2413/10001 [00:00<00:02, 3426.81it/s] 28%|██▊       | 2773/10001 [00:00<00:02, 3475.69it/s] 31%|███       | 3103/10001 [00:00<00:02, 3416.21it/s] 35%|███▍      | 3455/10001 [00:01<00:01, 3380.56it/s] 38%|███▊      | 3796/10001 [00:01<00:01, 3387.07it/s] 41%|████▏     | 4133/10001 [00:01<00:01, 3380.17it/s] 45%|████▍     | 4467/10001 [00:01<00:01, 3261.42it/s] 48%|████▊     | 4826/10001 [00:01<00:01, 3352.07it/s] 52%|█████▏    | 5162/10001 [00:01<00:01, 3327.17it/s] 55%|█████▌    | 5504/10001 [00:01<00:01, 3353.85it/s] 58%|█████▊    | 5840/10001 [00:01<00:01, 3255.46it/s] 62%|██████▏   | 6196/10001 [00:01<00:01, 3339.77it/s] 66%|██████▌   | 6556/10001 [00:01<00:01, 3413.12it/s] 69%|██████▉   | 6931/10001 [00:02<00:00, 3505.33it/s] 73%|███████▎  | 7306/10001 [00:02<00:00, 3574.62it/s] 77%|███████▋  | 7665/10001 [00:02<00:00, 3199.06it/s] 80%|███████▉  | 7994/10001 [00:02<00:00, 2789.16it/s] 84%|████████▎ | 8357/10001 [00:02<00:00, 2996.98it/s] 87%|████████▋ | 8714/10001 [00:02<00:00, 3146.91it/s] 91%|█████████ | 9069/10001 [00:02<00:00, 3256.94it/s] 94%|█████████▍| 9414/10001 [00:02<00:00, 3310.74it/s] 98%|█████████▊| 9764/10001 [00:02<00:00, 3365.14it/s]100%|██████████| 10001/10001 [00:02<00:00, 3339.92it/s]2019-02-24 05:35:39.007573: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-02-24 05:35:39.184046: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:06:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2019-02-24 05:35:39.184090: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-02-24 05:35:39.503767: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-02-24 05:35:39.503814: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-02-24 05:35:39.503821: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-02-24 05:35:39.504075: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10758 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:06:00.0, compute capability: 3.7)
41
[151, 439, 964, 1154, 1353, 1570, 1655, 2164, 2271, 2490, 2665, 3476, 3625, 3642, 3842, 4855, 4968, 4989, 5060, 5133, 5352, 5757, 5871, 5931, 6215, 6240, 6659, 6848, 6855, 6881, 6926, 7175, 7180, 7337, 7362, 7933, 7991, 8066, 8943, 9426, 10001]
46
[151, 439, 724, 840, 964, 1154, 1353, 1570, 1655, 2164, 2271, 2490, 2665, 3476, 3625, 3642, 3842, 4136, 4855, 4968, 4989, 5060, 5133, 5352, 5757, 5871, 5931, 6123, 6240, 6659, 6848, 6855, 6881, 6926, 7175, 7180, 7337, 7362, 7933, 7991, 8066, 8884, 8943, 9426, 9603, 10001]
9960
9954
(15931, 512, 512, 1)
(3983, 512, 512, 1)
(15931, 2)
(3983, 2)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 510, 510, 1)       10        
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 2, 2, 64)          16581248  
_________________________________________________________________
flatten (Flatten)            (None, 256)               0         
_________________________________________________________________
dense (Dense)                (None, 2)                 514       
_________________________________________________________________
softmax (Softmax)            (None, 2)                 0         
=================================================================
Total params: 16,581,772
Trainable params: 16,581,772
Non-trainable params: 0
_________________________________________________________________
Train on 13541 samples, validate on 2390 samples
Epoch 1/40
 - 291s - loss: 0.7345 - categorical_accuracy: 0.5060 - val_loss: 0.8976 - val_categorical_accuracy: 0.5025
Epoch 2/40
 - 132s - loss: 0.5857 - categorical_accuracy: 0.7810 - val_loss: 0.6150 - val_categorical_accuracy: 0.6397
Epoch 3/40
 - 132s - loss: 0.2990 - categorical_accuracy: 0.9383 - val_loss: 0.3101 - val_categorical_accuracy: 0.9038
Epoch 4/40
 - 133s - loss: 0.1789 - categorical_accuracy: 0.9468 - val_loss: 0.5503 - val_categorical_accuracy: 0.7808
Epoch 5/40
 - 130s - loss: 0.1075 - categorical_accuracy: 0.9614 - val_loss: 0.1572 - val_categorical_accuracy: 0.9448
Epoch 6/40
 - 130s - loss: 0.0766 - categorical_accuracy: 0.9708 - val_loss: 0.1624 - val_categorical_accuracy: 0.9456
Epoch 7/40
 - 130s - loss: 0.0687 - categorical_accuracy: 0.9764 - val_loss: 0.1506 - val_categorical_accuracy: 0.9464
Epoch 8/40
 - 130s - loss: 0.0429 - categorical_accuracy: 0.9816 - val_loss: 0.1040 - val_categorical_accuracy: 0.9649
Epoch 9/40
 - 130s - loss: 0.0426 - categorical_accuracy: 0.9826 - val_loss: 0.4642 - val_categorical_accuracy: 0.6858
Epoch 10/40
 - 130s - loss: 0.0429 - categorical_accuracy: 0.9844 - val_loss: 0.1119 - val_categorical_accuracy: 0.9611
Epoch 11/40
 - 130s - loss: 0.0322 - categorical_accuracy: 0.9869 - val_loss: 0.1146 - val_categorical_accuracy: 0.9594
Epoch 12/40
 - 130s - loss: 0.0313 - categorical_accuracy: 0.9863 - val_loss: 0.0843 - val_categorical_accuracy: 0.9678
Epoch 13/40
 - 130s - loss: 0.0271 - categorical_accuracy: 0.9880 - val_loss: 0.1076 - val_categorical_accuracy: 0.9619
Epoch 14/40
 - 130s - loss: 0.0258 - categorical_accuracy: 0.9889 - val_loss: 0.1006 - val_categorical_accuracy: 0.9653
Epoch 15/40
 - 130s - loss: 0.0198 - categorical_accuracy: 0.9915 - val_loss: 0.1065 - val_categorical_accuracy: 0.9632
Epoch 16/40
 - 130s - loss: 0.0207 - categorical_accuracy: 0.9914 - val_loss: 0.0840 - val_categorical_accuracy: 0.9720
Epoch 17/40
 - 130s - loss: 0.0205 - categorical_accuracy: 0.9914 - val_loss: 0.0933 - val_categorical_accuracy: 0.9674
Epoch 18/40
 - 130s - loss: 0.0203 - categorical_accuracy: 0.9911 - val_loss: 0.5220 - val_categorical_accuracy: 0.8590
Epoch 19/40
 - 130s - loss: 0.0281 - categorical_accuracy: 0.9900 - val_loss: 0.0885 - val_categorical_accuracy: 0.9699
Epoch 20/40
 - 130s - loss: 0.0248 - categorical_accuracy: 0.9894 - val_loss: 0.0947 - val_categorical_accuracy: 0.9682
Epoch 21/40
 - 130s - loss: 0.0223 - categorical_accuracy: 0.9912 - val_loss: 0.0829 - val_categorical_accuracy: 0.9711
Epoch 22/40
 - 130s - loss: 0.0207 - categorical_accuracy: 0.9910 - val_loss: 0.0914 - val_categorical_accuracy: 0.9678
Epoch 23/40
 - 130s - loss: 0.0196 - categorical_accuracy: 0.9917 - val_loss: 0.0797 - val_categorical_accuracy: 0.9715
Epoch 24/40
 - 130s - loss: 0.0227 - categorical_accuracy: 0.9903 - val_loss: 0.0730 - val_categorical_accuracy: 0.9736
Epoch 25/40
 - 130s - loss: 0.0185 - categorical_accuracy: 0.9917 - val_loss: 0.0945 - val_categorical_accuracy: 0.9665
Epoch 26/40
 - 130s - loss: 0.0202 - categorical_accuracy: 0.9916 - val_loss: 0.0795 - val_categorical_accuracy: 0.9724
Epoch 27/40
 - 131s - loss: 0.0174 - categorical_accuracy: 0.9928 - val_loss: 0.0766 - val_categorical_accuracy: 0.9741
Epoch 28/40
 - 130s - loss: 0.0516 - categorical_accuracy: 0.9847 - val_loss: 0.0950 - val_categorical_accuracy: 0.9699
Epoch 29/40
 - 130s - loss: 0.0248 - categorical_accuracy: 0.9905 - val_loss: 0.1149 - val_categorical_accuracy: 0.9598
Epoch 30/40
 - 130s - loss: 0.0206 - categorical_accuracy: 0.9918 - val_loss: 0.0795 - val_categorical_accuracy: 0.9728
Epoch 31/40
 - 130s - loss: 0.0188 - categorical_accuracy: 0.9916 - val_loss: 0.0663 - val_categorical_accuracy: 0.9745
Epoch 32/40
 - 130s - loss: 0.0158 - categorical_accuracy: 0.9922 - val_loss: 0.0791 - val_categorical_accuracy: 0.9711
Epoch 33/40
 - 130s - loss: 0.0159 - categorical_accuracy: 0.9926 - val_loss: 0.0781 - val_categorical_accuracy: 0.9728
Epoch 34/40
 - 130s - loss: 0.0153 - categorical_accuracy: 0.9930 - val_loss: 0.0627 - val_categorical_accuracy: 0.9749
Epoch 35/40
 - 130s - loss: 0.0146 - categorical_accuracy: 0.9936 - val_loss: 0.0811 - val_categorical_accuracy: 0.9715
Epoch 36/40
 - 130s - loss: 0.0136 - categorical_accuracy: 0.9939 - val_loss: 0.0972 - val_categorical_accuracy: 0.9682
Epoch 37/40
 - 130s - loss: 0.0121 - categorical_accuracy: 0.9947 - val_loss: 0.0946 - val_categorical_accuracy: 0.9699
Epoch 38/40
 - 130s - loss: 0.0125 - categorical_accuracy: 0.9948 - val_loss: 0.0876 - val_categorical_accuracy: 0.9711
Epoch 39/40
 - 130s - loss: 0.0137 - categorical_accuracy: 0.9942 - val_loss: 0.0758 - val_categorical_accuracy: 0.9745
Epoch 40/40
 - 131s - loss: 0.0116 - categorical_accuracy: 0.9948 - val_loss: 0.0792 - val_categorical_accuracy: 0.9741

Using TensorFlow backend.

 Test accuracy: 0.9688676876875734
